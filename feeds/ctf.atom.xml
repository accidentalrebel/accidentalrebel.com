<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>AccidentalRebel.com - CTF</title><link href="https://www.accidentalrebel.com/" rel="alternate"/><link href="https://www.accidentalrebel.com/feeds/ctf.atom.xml" rel="self"/><id>https://www.accidentalrebel.com/</id><updated>2021-04-30T05:58:00+08:00</updated><entry><title>Emprisa Maldoc Writeup</title><link href="https://www.accidentalrebel.com/emprisa-maldoc-writeup..html" rel="alternate"/><published>2021-04-30T05:58:00+08:00</published><updated>2021-04-30T05:58:00+08:00</updated><author><name>AccidentalRebel</name></author><id>tag:www.accidentalrebel.com,2021-04-30:/emprisa-maldoc-writeup..html</id><summary type="html">&lt;blockquote&gt;
&lt;p&gt;This is a writeup for &lt;a href="the-emprisa-maldoc-challenge"&gt;Emprisa maldoc challenge&lt;/a&gt; that I made for &lt;a href="https://cyberdefenders.org/"&gt;CyberDefenders.org&lt;/a&gt;. You can play it &lt;a href="https://cyberdefenders.org/labs/56"&gt;here&lt;/a&gt;.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;The very first thing that I do when confronted with a malicious document is to run it in a malware lab. This particular document, however, would not exhibit anything malicious on recent versions of Word.&lt;/p&gt;
&lt;p&gt;A quick search of the hash on malware sandboxes would reveal that the document makes use of the &lt;a href="https://nvd.nist.gov/vuln/detail/CVE-2017-18822"&gt;CVE-2017-18822 vulnerability&lt;/a&gt;. This is a vulnerability that became known and was promptly patched around November of 2017.&lt;/p&gt;
&lt;p&gt;The above details give us a hint on how to trigger the document, which is to run the maldoc on a version of Microsoft Word that doesn't have the patches that fix the vulnerability. The easiest way to do this is to boot up a new VM with a fresh install of Windows 7 and with updates disabled.&lt;/p&gt;
&lt;p&gt;This new environment …&lt;/p&gt;</summary><content type="html">&lt;blockquote&gt;
&lt;p&gt;This is a writeup for &lt;a href="the-emprisa-maldoc-challenge"&gt;Emprisa maldoc challenge&lt;/a&gt; that I made for &lt;a href="https://cyberdefenders.org/"&gt;CyberDefenders.org&lt;/a&gt;. You can play it &lt;a href="https://cyberdefenders.org/labs/56"&gt;here&lt;/a&gt;.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;The very first thing that I do when confronted with a malicious document is to run it in a malware lab. This particular document, however, would not exhibit anything malicious on recent versions of Word.&lt;/p&gt;
&lt;p&gt;A quick search of the hash on malware sandboxes would reveal that the document makes use of the &lt;a href="https://nvd.nist.gov/vuln/detail/CVE-2017-18822"&gt;CVE-2017-18822 vulnerability&lt;/a&gt;. This is a vulnerability that became known and was promptly patched around November of 2017.&lt;/p&gt;
&lt;p&gt;The above details give us a hint on how to trigger the document, which is to run the maldoc on a version of Microsoft Word that doesn't have the patches that fix the vulnerability. The easiest way to do this is to boot up a new VM with a fresh install of Windows 7 and with updates disabled.&lt;/p&gt;
&lt;p&gt;This new environment is where the document would trigger once double-clicked. After a bit of loading, a pop-up would later appear greeting the analyst with congratulations (this is a stand-in for a malicious payload for this challenge), but of course, it is clear that we are not done yet.&lt;/p&gt;
&lt;p&gt;&lt;img alt="emprisa-maldoc-writeup-01" src="https://www.accidentalrebel.com/images/emprisa-maldoc-writeup-01.png" /&gt;&lt;/p&gt;
&lt;p&gt;Tools such as &lt;a href="https://processhacker.sourceforge.io/"&gt;Process Hacker&lt;/a&gt; will reveal a new process named &lt;code&gt;EQNEDT32.EXE&lt;/code&gt; getting spawned right after opening the document. Those who have read through the CVE details would know that this is the expected behavior, as the vulnerability uses this process to run malicious code. In this case, the exploit downloads a file from the internet and automatically runs it.&lt;/p&gt;
&lt;p&gt;Another tool such as &lt;a href="https://sourceforge.net/projects/regshot/"&gt;Regshot&lt;/a&gt; would reveal newly created files. It can determine these by taking a snapshot before the malicious document is opened, then taking another one after the downloaded payload gets triggered, and finally comparing the two snapshots and listing the differences. It's an invaluable tool to have.&lt;/p&gt;
&lt;p&gt;&lt;img alt="emprisa-maldoc-writeup-02" src="https://www.accidentalrebel.com/images/emprisa-maldoc-writeup-02.png" /&gt;&lt;/p&gt;
&lt;p&gt;Running &lt;a href="https://github.com/DidierStevens/DidierStevensSuite/blob/master/rtfdump.py"&gt;rtfdump.py&lt;/a&gt; would then reveal some telling details about our maldoc, like for example, magic signatures and object streams.&lt;/p&gt;
&lt;p&gt;Upon close inspection of the hexdump of the largest object stream (still via rtfdump), one would see a sequence of NOPs (aka a NOPsled) in certain parts. A NOPsled such as this usually indicates the possible start of shellcode. Carving this part of the shellcode and running it on an emulator such as &lt;a href="https://github.com/fireeye/speakeasy"&gt;speakeasy&lt;/a&gt; or &lt;a href="http://sandsprite.com/blogs/index.php?uid=7&amp;amp;pid=152"&gt;scdbg&lt;/a&gt; won't work properly, however.&lt;/p&gt;
&lt;p&gt;&lt;img alt="emprisa-maldoc-writeup-03" src="https://www.accidentalrebel.com/images/emprisa-maldoc-writeup-03.png" /&gt;&lt;/p&gt;
&lt;p&gt;The output shows the first line to be &lt;code&gt;LoadLibrary&lt;/code&gt;, and then there's an error after that. This indicates that maybe there's a problem with the shellcode. &lt;/p&gt;
&lt;p&gt;On further inspection, a little more further down there is another set of seemingly readable strings. This could indicate another shellcode. Or, maybe, a continuation of the first one? In between these supposed two shellcodes is a readable string that seems out of place in between the gibberish. Carving the two shellcodes and then combining them would now work when run on an emulator.&lt;/p&gt;
&lt;p&gt;&lt;img alt="emprisa-maldoc-writeup-04" src="https://www.accidentalrebel.com/images/emprisa-maldoc-writeup-04.png" /&gt;&lt;/p&gt;
&lt;p&gt;If the previous solution was not immediately clear to you then there is another approach to the above. And that is to step through the &lt;code&gt;EQNEDT32&lt;/code&gt; process as soon as it runs. However, attaching to this process is tricky as it triggers only for a split second and then exits. To debug this, a debugger should be automatically connected as soon as the process starts. Check out &lt;a href="https://pentestlab.blog/2020/01/13/persistence-image-file-execution-options-injection/"&gt;this post&lt;/a&gt; for details on how to do this.&lt;/p&gt;
&lt;p&gt;Once attached, the painstaking process of debugging begins. Thankfully, we have an idea of what code is being loaded into memory. And this is the shellcode that has a NOPSled during our analysis with rtfdump.py above. Looking for this sequence and then putting a breakpoint where the memory location is accessed would stop the program just before the shellcode is run. Once the breakpoint triggered, we could step through the shellcode and find out what exactly the shellcode does and which Libraries are being called.&lt;/p&gt;
&lt;p&gt;From here, we could also backtrack from where the shellcode is called to figure out how the exploit is triggered via a buffer overflow. This requires a bit of knowledge in reverse engineering. An alternative is to &lt;a href="https://nvd.nist.gov/vuln/detail/CVE-2017-18822"&gt;check out the CVE details&lt;/a&gt; in search for the tool that was likely used to make the exploit, and then examining the code.&lt;/p&gt;
&lt;p&gt;After all of that, you should have everything that you need to answer all the questions in the challenge. You may have noticed that I have not revealed the answers outright. You still have to find it on your own. However, I do hope that by walking you through the process, I have helped you understand how to get there.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;If you have more questions, or want to tell me what you think of the challenge, feel free to leave a comment below or send me a mesage at @accidentalrebel. &lt;/p&gt;
&lt;/blockquote&gt;</content><category term="CTF"/><category term="maldoc"/><category term="writeup"/></entry><entry><title>The Emprisa Maldoc Challenge</title><link href="https://www.accidentalrebel.com/the-emprisa-maldoc-challenge.html" rel="alternate"/><published>2021-04-04T16:37:00+08:00</published><updated>2021-04-04T16:37:00+08:00</updated><author><name>AccidentalRebel</name></author><id>tag:www.accidentalrebel.com,2021-04-04:/the-emprisa-maldoc-challenge.html</id><summary type="html">&lt;p&gt;I was inspired to make my own CTF challenge after finishing &lt;a href="https://www.accidentalrebel.com/maldoc101-writeup-part-1.html"&gt;Maldoc101&lt;/a&gt; found at &lt;a href="https://cyberdefenders.org/"&gt;Cyberdefenders.org&lt;/a&gt;. The challenge I made is called &lt;a href="https://cyberdefenders.org/labs/56"&gt;Emprisa Maldoc&lt;/a&gt; and it is now up on their website. &lt;/p&gt;
&lt;p&gt;Emprisa is based on a malicious document that I downloaded blindly from a malware sandbox. It used a relatively old but still interesting exploit that is still in use today. After researching more about it I came across a tool that can generate a malicious doc using the same exact exploit. This is when I got the idea to turn it into a challenge.&lt;/p&gt;
&lt;p&gt;&lt;img alt="the-emprisa-maldoc-challenge-01" src="https://www.accidentalrebel.com/images/the-emprisa-maldoc-challenge-01.png" /&gt;&lt;/p&gt;
&lt;p&gt;The challenge has 14 questions with increasing and varying difficulty. The challenge is targeted towards intermediate analysts who already have experience examining maldocs before. The goal is to reinforce the use of common malware analysis tools, but at the same time, teach players new things and techniques. It involves flexing muscles related to open …&lt;/p&gt;</summary><content type="html">&lt;p&gt;I was inspired to make my own CTF challenge after finishing &lt;a href="https://www.accidentalrebel.com/maldoc101-writeup-part-1.html"&gt;Maldoc101&lt;/a&gt; found at &lt;a href="https://cyberdefenders.org/"&gt;Cyberdefenders.org&lt;/a&gt;. The challenge I made is called &lt;a href="https://cyberdefenders.org/labs/56"&gt;Emprisa Maldoc&lt;/a&gt; and it is now up on their website. &lt;/p&gt;
&lt;p&gt;Emprisa is based on a malicious document that I downloaded blindly from a malware sandbox. It used a relatively old but still interesting exploit that is still in use today. After researching more about it I came across a tool that can generate a malicious doc using the same exact exploit. This is when I got the idea to turn it into a challenge.&lt;/p&gt;
&lt;p&gt;&lt;img alt="the-emprisa-maldoc-challenge-01" src="https://www.accidentalrebel.com/images/the-emprisa-maldoc-challenge-01.png" /&gt;&lt;/p&gt;
&lt;p&gt;The challenge has 14 questions with increasing and varying difficulty. The challenge is targeted towards intermediate analysts who already have experience examining maldocs before. The goal is to reinforce the use of common malware analysis tools, but at the same time, teach players new things and techniques. It involves flexing muscles related to open source intelligence, examining shellcodes, and debugging processes. &lt;/p&gt;
&lt;p&gt;I don't want to spoil too much but if you are for it, you can give it a go &lt;a href="https://cyberdefenders.org/labs/51"&gt;here&lt;/a&gt;. It was hella fun to make and I do hope that it is also as fun to solve!&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;Official write-up with hints coming soon.&lt;/p&gt;
&lt;p&gt;I would like to extend my thanks to the team behind CyberDefenders.org. They accepted my submission, reviewed it, and worked with me in improving it. And also to &lt;a href="https://twitter.com/jstrosch"&gt;Josh Stroschein&lt;/a&gt; for making Maldoc101 and being kind enough to entertain me with my questions related to making challenges.&lt;/p&gt;</content><category term="CTF"/><category term="maldoc"/><category term="ctf"/></entry><entry><title>Hunt the Kingdom CTF Challenge</title><link href="https://www.accidentalrebel.com/hunt-the-kingdom-ctf-challenge.html" rel="alternate"/><published>2020-10-05T11:13:00+08:00</published><updated>2020-10-05T11:13:00+08:00</updated><author><name>AccidentalRebel</name></author><id>tag:www.accidentalrebel.com,2020-10-05:/hunt-the-kingdom-ctf-challenge.html</id><summary type="html">&lt;blockquote&gt;
&lt;p&gt;TLDR: Participated in a blue team CTF, had a lot of fun, looking forward for more&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Yesterday I participated in the &lt;a href="https://www.facebook.com/guidemtraining"&gt;GuideM "Hunt the Kingdom" CTF challenge&lt;/a&gt;. It served as the final activity at the end of the &lt;em&gt;"Cyber Defense and Threat Hunting"&lt;/em&gt; course.&lt;/p&gt;
&lt;p&gt;I was looking forward to this CTF, especially after my awesome experience with the &lt;a href="https://www.accidentalrebel.com/covidscammers-writeup--defcon-rtv-ctf.html"&gt;Red Team Village CTF at Defcon&lt;/a&gt;. This one is centered on the Blue Team side, and I was curious as to how it will play out.&lt;/p&gt;
&lt;h2 id="the-preparation"&gt;The Preparation&lt;/h2&gt;
&lt;p&gt;I took one whole day to study and prepare. I went through all our slides and have written down the important concepts and commands to an org file. This is important because I wanted them to be easily searchable, which helped a lot during the challenge.&lt;/p&gt;
&lt;p&gt;I also did research about the Hunt the Kingdom challenge itself. There weren't much information online about it …&lt;/p&gt;</summary><content type="html">&lt;blockquote&gt;
&lt;p&gt;TLDR: Participated in a blue team CTF, had a lot of fun, looking forward for more&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Yesterday I participated in the &lt;a href="https://www.facebook.com/guidemtraining"&gt;GuideM "Hunt the Kingdom" CTF challenge&lt;/a&gt;. It served as the final activity at the end of the &lt;em&gt;"Cyber Defense and Threat Hunting"&lt;/em&gt; course.&lt;/p&gt;
&lt;p&gt;I was looking forward to this CTF, especially after my awesome experience with the &lt;a href="https://www.accidentalrebel.com/covidscammers-writeup--defcon-rtv-ctf.html"&gt;Red Team Village CTF at Defcon&lt;/a&gt;. This one is centered on the Blue Team side, and I was curious as to how it will play out.&lt;/p&gt;
&lt;h2 id="the-preparation"&gt;The Preparation&lt;/h2&gt;
&lt;p&gt;I took one whole day to study and prepare. I went through all our slides and have written down the important concepts and commands to an org file. This is important because I wanted them to be easily searchable, which helped a lot during the challenge.&lt;/p&gt;
&lt;p&gt;I also did research about the Hunt the Kingdom challenge itself. There weren't much information online about it but there were &lt;a href="https://www.facebook.com/guidemtraining/photos/a.142012317191141/229536238438748/"&gt;some social media posts&lt;/a&gt; that contained screenshots on how the challenge looked like. These gave me a lot of information on what to expect.&lt;/p&gt;
&lt;p&gt;&lt;img alt="hunt-the-kingdom-ctf-challenge-01" src="https://www.accidentalrebel.com/images/hunt-the-kingdom-ctf-challenge-01.jpg" /&gt;&lt;/p&gt;
&lt;div class="codehilite"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;It&amp;#39;s OSINT in practice :P
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;For example, with the screenshot above I learned how the UI looked like, that there were categories that we could switch to, leaderboards, how a question is structured, and that "areas" on the map can get added, enabled, and disabled during the game. The last part is particularly important as it means that not all questions are available from the start and some can get disabled during the game.&lt;/p&gt;
&lt;p&gt;Thanks to the above research I felt confident that I could hit the ground running as soon as the game started. I picked my name (AccidentalRebel, of course) and my emblem and I was ready for the hunt.&lt;/p&gt;
&lt;p&gt;&lt;img alt="hunt-the-kingdom-ctf-challenge-02" src="https://www.accidentalrebel.com/images/hunt-the-kingdom-ctf-challenge-02.png" /&gt;&lt;/p&gt;
&lt;div class="codehilite"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;Yes, that&amp;#39;s the blue tank from Advance Wars, because I&amp;#39;m part of the &amp;quot;blue team&amp;quot;.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2 id="the-hunt"&gt;The Hunt&lt;/h2&gt;
&lt;p&gt;When the hunt started my approach was to focus on the easy problems first. Getting them out of the way early would allow me to rack up points and just focus on the hard ones afterwards. This did the trick and I was able to maintain an early lead.&lt;/p&gt;
&lt;p&gt;During the mid-game my computer hanged from all the switching between VMs (There were 3 VMs that we needed to use to solve the problems). &lt;em&gt;Note to self: get a beefier PC&lt;/em&gt;. I got a bit frustrated by this but decided that instead of waiting for Windows to boot I could use the time to take a break and got lunch. &lt;/p&gt;
&lt;p&gt;&lt;img alt="hunt-the-kingdom-ctf-challenge-03" src="https://www.accidentalrebel.com/images/hunt-the-kingdom-ctf-challenge-03.53" /&gt;&lt;/p&gt;
&lt;p&gt;I came back to the game all full and refreshed, but sadly, I have already lost my lead. I felt a bit disappointed by this but I continued to push through. I removed the leaderboards to minimize distractions which helped. No need to pressure myself, I told myself. Although, I admit that I did peek from time to time.&lt;/p&gt;
&lt;p&gt;With the renewed focus I was able to keep my standing in the top 3. The leader of the pack during the end-game was &lt;em&gt;BoyHack3r&lt;/em&gt;, a worthy opponent who was always a few points ahead of me. &lt;/p&gt;
&lt;p&gt;There was one question that has a lot of points that only has one solve. I knew that if I could get that it would give me enough points to snatch back 1st place. It wasn't an easy problem though so I changed my approach by slowing down which helped me understand the questions better. A few minutes later I was back at first place.&lt;/p&gt;
&lt;p&gt;I've never done a celebratory fist pump before, this was the first time.&lt;/p&gt;
&lt;h2 id="the-final-minutes"&gt;The Final Minutes&lt;/h2&gt;
&lt;p&gt;I was able to maintain first place position by continuously answering questions until I was left with just four questions. These four are problems that no one has solved yet. The activity on the leaderboards have lessened which I took to mean that the others were stuck like me. I was at 13740 points, BoyHack3r at 13590, and Overwatch at 13460. If any of them managed to solve just one out of these four problems then they'll easily overtake me.&lt;/p&gt;
&lt;p&gt;I wasn't going to let that happen though. At 5 minutes left I continued solving the one that I had the most progress with. But it wasn't enough and I ran out of time. The others didn't get their lucky break either which finally cemented the scores on the boards.&lt;/p&gt;
&lt;p&gt;&lt;img alt="hunt-the-kingdom-ctf-challenge-04" src="https://www.accidentalrebel.com/images/hunt-the-kingdom-ctf-challenge-04.PNG" /&gt;&lt;/p&gt;
&lt;p&gt;After 6 hours of back-breaking hunting I was finally able to breathe a sigh of relief. &lt;/p&gt;
&lt;h2 id="the-end"&gt;The End&lt;/h2&gt;
&lt;p&gt;I rarely engage in any competitive activity so my competitive side rarely comes out. This CTF definitely brought it out and gave me the push to take the challenge seriously. I didn't do it for the prizes though. I did it because I wanted to prove to myself that I have what it takes, especially since I don't have a formal background in CyberSecurity. While a CTF is not an accurate qualification of being part of a blue team, it does show a participant's ability to work and solve problems under pressure.&lt;/p&gt;
&lt;p&gt;I want to give a shoutout to &lt;a href="https://www.facebook.com/guidemtraining"&gt;GuideM&lt;/a&gt; for guiding us throughout the course and for the extremely fun CTF challenge. Also to &lt;em&gt;BoyHack3r&lt;/em&gt;, &lt;em&gt;Overwatch&lt;/em&gt;, and &lt;em&gt;:]&lt;/em&gt; for making me sweat bullets.&lt;/p&gt;
&lt;p&gt;This is another big step for me into the world of cybersecurity and I do hope I could learn more and improve. I look forward to the next CTF!&lt;/p&gt;</content><category term="CTF"/><category term="ctf"/><category term="cybersecurity"/></entry><entry><title>CovidScammers writeup (Defcon RTV CTF)</title><link href="https://www.accidentalrebel.com/covidscammers-writeup--defcon-rtv-ctf.html" rel="alternate"/><published>2020-08-13T16:58:00+08:00</published><updated>2020-08-13T16:58:00+08:00</updated><author><name>AccidentalRebel</name></author><id>tag:www.accidentalrebel.com,2020-08-13:/covidscammers-writeup--defcon-rtv-ctf.html</id><summary type="html">&lt;p&gt;I joined the &lt;a href="https://ctf.threatsims.com"&gt;Defcon Red Team Village CTF&lt;/a&gt; because I was curious about it and I wanted to test out the skills that I have gained playing with CTF sites like &lt;a href="https://overthewire.org/wargames/"&gt;overthewire.org&lt;/a&gt; and &lt;a href="https://www.vulnhub.com/"&gt;vulnhub&lt;/a&gt;. I knew that the challenges won't be easy, but thankfully, I was able to join up with other newbies who were willing to give it a go and learn with each other.&lt;/p&gt;
&lt;p&gt;Unfortunately, I fell asleep just before the CTF started and when I woke up all the easy challenges were already solved by my team members. There was one easy challenge that was still open on the CovidScammers category, so I quickly got started to solving that.&lt;/p&gt;
&lt;h2 id="free-flag-and-binary-1-point"&gt;Free Flag (and binary) [1 point]&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;You've been contacted by a high-end but morally ambiguous finance company (unhackable-bitcoin-wallet.com) to investigate a data breach. The box in question is a mail server in their internal network, a …&lt;/p&gt;&lt;/blockquote&gt;</summary><content type="html">&lt;p&gt;I joined the &lt;a href="https://ctf.threatsims.com"&gt;Defcon Red Team Village CTF&lt;/a&gt; because I was curious about it and I wanted to test out the skills that I have gained playing with CTF sites like &lt;a href="https://overthewire.org/wargames/"&gt;overthewire.org&lt;/a&gt; and &lt;a href="https://www.vulnhub.com/"&gt;vulnhub&lt;/a&gt;. I knew that the challenges won't be easy, but thankfully, I was able to join up with other newbies who were willing to give it a go and learn with each other.&lt;/p&gt;
&lt;p&gt;Unfortunately, I fell asleep just before the CTF started and when I woke up all the easy challenges were already solved by my team members. There was one easy challenge that was still open on the CovidScammers category, so I quickly got started to solving that.&lt;/p&gt;
&lt;h2 id="free-flag-and-binary-1-point"&gt;Free Flag (and binary) [1 point]&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;You've been contacted by a high-end but morally ambiguous finance company (unhackable-bitcoin-wallet.com) to investigate a data breach. The box in question is a mail server in their internal network, a sample of the malware found on the system has been pulled and given to you. Your task, should you choose to accept it, is to reverse-engineer the sample and locate, fuzz and exploit the C2 server, and then hack-back to learn about the malicious actor and recover the stolen documents.
Look for the free flag. Get on the scoreboard!&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;I admit that in a hurry to get points I did not properly read the description of the challenge. I understood that I'll be downloading and reverse-engineering something. But it did not register on my mind that it's actually malware.&lt;/p&gt;
&lt;p&gt;The download was a binary that doesn't do anything when run. My first instict was to use &lt;code&gt;strings&lt;/code&gt; to look for the flag, which turned out to be correct.&lt;/p&gt;
&lt;p&gt;&lt;img alt="giving-malware-to-a-noob--defcon-rtv-ctf-covidscammers-writeup-01" src="https://www.accidentalrebel.com/images/giving-malware-to-a-noob--defcon-rtv-ctf-covidscammers-writeup-01.png" /&gt;&lt;/p&gt;
&lt;p&gt;The flag is: &lt;code&gt;TS{freeFlagLookAtMe}&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Unfortunately, this challenge was already solved by a team member so I did not get the free flag. The second one, is still open though.&lt;/p&gt;
&lt;h2 id="syscalls-5-points"&gt;Syscalls [5 points]&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;What syscall is hindering your dynamic analysis? Flag is just the syscall, no brackets or anything.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;If we run the file from within gdb to debug it we get:&lt;/p&gt;
&lt;p&gt;&lt;img alt="giving-malware-to-a-noob--defcon-rtv-ctf-covidscammers-writeup-02" src="https://www.accidentalrebel.com/images/giving-malware-to-a-noob--defcon-rtv-ctf-covidscammers-writeup-02.png" /&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;can't debug this, na na na na...&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;So from the description we are looking for a syscall that is hindering the debugging of the binary. If we want to find out what syscalls are called by a program, we could determine that using the &lt;code&gt;strace&lt;/code&gt; command.&lt;/p&gt;
&lt;p&gt;&lt;img alt="giving-malware-to-a-noob--defcon-rtv-ctf-covidscammers-writeup-03" src="https://www.accidentalrebel.com/images/giving-malware-to-a-noob--defcon-rtv-ctf-covidscammers-writeup-03.png" /&gt;&lt;/p&gt;
&lt;p&gt;Just before the write syscall for the "na na na" message we see:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ptrace(TRACE_TRACEME) = -1 EPERM (Operation not permitted)&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;I'm unfamiliar with &lt;code&gt;ptrace&lt;/code&gt; so I researched it and tried to understand how it could prevent debugging. I learned that &lt;code&gt;ptrace&lt;/code&gt; can be used as an anti-debugging technique as can be seen &lt;a href="https://www.aldeid.com/wiki/Ptrace-anti-debugging"&gt;here&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Sure, enough the flag is: &lt;code&gt;ptrace&lt;/code&gt;. &lt;/p&gt;
&lt;p&gt;I got 5 points from this and I finally have a contribution to my team! Unfortunately, real life prevented me from continuing with the CTF and I had to bow out early.&lt;/p&gt;
&lt;h3 id="sidenote-how-to-bypass-ptrace"&gt;Sidenote: How to bypass ptrace?&lt;/h3&gt;
&lt;p&gt;How does one bypass this anti-debugging feature? &lt;a href="https://dev.to/denisnutiu/bypassing-ptrace-calls-with-ldpreload-on-linux-12jl"&gt;Here's one approach&lt;/a&gt; that I tried which should work in theory but doesn't. My guess is that this particular binary has an additional way to prevent debugging, like it spawns a child process and it stays there even if you bypass ptrace. I'd have to look into this further in the future.&lt;/p&gt;
&lt;h2 id="shared-secrets-150-points"&gt;Shared Secrets [150 points]&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;The malware creates a shared-memory object and stores a flag inside. Recover the flag. Flag has the TS{} format, you'll know when you get it.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;I was able to solve this challenge after the CTF preliminaries ended. By this time I was already well rested and have a clearer mind. It was also at this time that I realized that the file is actually a malware and has already infected my machine. Thankfully, I was running a virtual machine which meant I could just revert back to an old working restore point.&lt;/p&gt;
&lt;p&gt;Knowing that the file is a malware, the next step I did was to run &lt;code&gt;rkhunter&lt;/code&gt; to look for rootkits and suspcious files. This gave me an interesting finding:&lt;/p&gt;
&lt;p&gt;&lt;img alt="giving-malware-to-a-noob--defcon-rtv-ctf-covidscammers-writeup-04" src="https://www.accidentalrebel.com/images/giving-malware-to-a-noob--defcon-rtv-ctf-covidscammers-writeup-04.png" /&gt;&lt;/p&gt;
&lt;p&gt;Opening the suspicious file revealed this: &lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;KRJXW22FMVYES5CTMVBXERKUNNCWK4CJORJWCRTFFZGXERTSGBSE6IL5&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;This is not the flag yet, it needs to be in the "TS{}" format as instructed in the challenge description.&lt;/p&gt;
&lt;p&gt;I initially had a hard time figuring out how to decode this. It wasn't &lt;code&gt;base64&lt;/code&gt; nor any other popular encoding. Thankfully, there are tools like &lt;a href="https://gchq.github.io/CyberChef/"&gt;CyberChef&lt;/a&gt; to help with this kind of problem. After some experimentation, the "magic" recipe did the trick and revealed to me that it was actually a &lt;code&gt;base32&lt;/code&gt; encoding.&lt;/p&gt;
&lt;p&gt;&lt;img alt="giving-malware-to-a-noob--defcon-rtv-ctf-covidscammers-writeup-05" src="https://www.accidentalrebel.com/images/giving-malware-to-a-noob--defcon-rtv-ctf-covidscammers-writeup-05.png" /&gt;&lt;/p&gt;
&lt;p&gt;This gave me the flag: &lt;code&gt;TS{kEepItSeCrETkEepItSaFe.MrFr0dO!}&lt;/code&gt;&lt;/p&gt;
&lt;h2 id="license-and-registration-100-points"&gt;License and Registration [100 points]&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;The malware creates a UUID and stores it in a file, what is the name of this file. Provide the SHA1 hash of hte full path as the flag.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;So the description above says that a file is created by the malware and stores data inside of it. I figured that the easiest way to figure out what this created file is to: &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Restore to a previous restore point before I opened the malware&lt;/li&gt;
&lt;li&gt;Run the malware, and then;&lt;/li&gt;
&lt;li&gt;Inspect which other files were created at the time of execution. &lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;I found out which files were recently created during the last 2 minutes using the following command:&lt;/p&gt;
&lt;div class="codehilite"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$&lt;span class="w"&gt; &lt;/span&gt;find&lt;span class="w"&gt; &lt;/span&gt;/&lt;span class="w"&gt; &lt;/span&gt;-user&lt;span class="w"&gt; &lt;/span&gt;kali&lt;span class="w"&gt; &lt;/span&gt;-mmin&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-type&lt;span class="w"&gt; &lt;/span&gt;f&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;&amp;gt;&lt;span class="w"&gt; &lt;/span&gt;/dev/null
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;This showed me a lot of files, but after sifting through that I found one file that seesm promising.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;/tmp/.serverauth.tn6aUcM0uM&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;To get the flag I did this:&lt;/p&gt;
&lt;div class="codehilite"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;echo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-n&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;/tmp/.serverauth.tn6aUcM0uM&amp;quot;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;|&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;sha1sum
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Which resulted in this flag: &lt;code&gt;5b4e97047851682649a602ad62ba4af567e352a3&lt;/code&gt;&lt;/p&gt;
&lt;h2 id="to-be-continued"&gt;To be continued?&lt;/h2&gt;
&lt;p&gt;So I wanted to try and work on the other challenges but it seems that &lt;a href="https://ctf.threatsims.com"&gt;the ctf site&lt;/a&gt; is currently down. The site redirected to a different non https site and it spooked me so I stopped trying. Good thing that I had NoScript on.&lt;/p&gt;
&lt;p&gt;If you want a longer and more pro writeup about the CovidScammers challenges do check out &lt;a href="https://0xdf.gitlab.io/2020/05/04/covid-19-ctf-covidscammers.html"&gt;0xdf's writeup about it&lt;/a&gt;.&lt;/p&gt;</content><category term="CTF"/><category term="ctf"/><category term="writeup"/><category term="malware_analysis"/><category term="defcon"/></entry></feed>