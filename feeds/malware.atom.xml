<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>AccidentalRebel.com - malware</title><link href="https://www.accidentalrebel.com/" rel="alternate"/><link href="https://www.accidentalrebel.com/feeds/malware.atom.xml" rel="self"/><id>https://www.accidentalrebel.com/</id><updated>2023-01-23T21:02:00+08:00</updated><entry><title>Adding Automation to Blue-Jupyter Malware Notebook</title><link href="https://www.accidentalrebel.com/adding-automation-to-blue-jupyter-malware-notebook.html" rel="alternate"/><published>2023-01-23T21:02:00+08:00</published><updated>2023-01-23T21:02:00+08:00</updated><author><name>AccidentalRebel</name></author><id>tag:www.accidentalrebel.com,2023-01-23:/adding-automation-to-blue-jupyter-malware-notebook.html</id><summary type="html">&lt;p&gt;I came across the &lt;a href="https://github.com/mttaggart/blue-jupyter"&gt;Blue-Jupyter project on Github&lt;/a&gt; while researching Jupyter notebooks. This &lt;a href="https://www.youtube.com/watch?v=-EX5Ybbt8uE"&gt;short demo video&lt;/a&gt; got me excited, so I cloned the project and added some improvements that automate many things when I am looking for malware to investigate.&lt;/p&gt;
&lt;h1 id="what-are-jupyter-notebooks"&gt;What are Jupyter Notebooks?&lt;/h1&gt;
&lt;p&gt;For readers who may be unfamiliar, Jupyter Notebooks are a web-based tool that allows users to create and share documents that contain live code, equations, visualizations, and narrative text. They are a popular tool among data scientists and researchers but have also adapted for use in other fields, such as cybersecurity.&lt;/p&gt;
&lt;h1 id="my-additions-to-the-blue-jupyter"&gt;My Additions to the Blue-Jupyter&lt;/h1&gt;
&lt;p&gt;Many of the changes I've made are focused on automating the process of quickly looking for interesting new samples to investigate.&lt;/p&gt;
&lt;p&gt;One addition to the notebook is the automated downloading of samples from &lt;a href="https://bazaar.abuse.ch/"&gt;Malware Bazaar&lt;/a&gt;. This can download a maximum of 100 samples continuously. Additional information is listed to highlight …&lt;/p&gt;</summary><content type="html">&lt;p&gt;I came across the &lt;a href="https://github.com/mttaggart/blue-jupyter"&gt;Blue-Jupyter project on Github&lt;/a&gt; while researching Jupyter notebooks. This &lt;a href="https://www.youtube.com/watch?v=-EX5Ybbt8uE"&gt;short demo video&lt;/a&gt; got me excited, so I cloned the project and added some improvements that automate many things when I am looking for malware to investigate.&lt;/p&gt;
&lt;h1 id="what-are-jupyter-notebooks"&gt;What are Jupyter Notebooks?&lt;/h1&gt;
&lt;p&gt;For readers who may be unfamiliar, Jupyter Notebooks are a web-based tool that allows users to create and share documents that contain live code, equations, visualizations, and narrative text. They are a popular tool among data scientists and researchers but have also adapted for use in other fields, such as cybersecurity.&lt;/p&gt;
&lt;h1 id="my-additions-to-the-blue-jupyter"&gt;My Additions to the Blue-Jupyter&lt;/h1&gt;
&lt;p&gt;Many of the changes I've made are focused on automating the process of quickly looking for interesting new samples to investigate.&lt;/p&gt;
&lt;p&gt;One addition to the notebook is the automated downloading of samples from &lt;a href="https://bazaar.abuse.ch/"&gt;Malware Bazaar&lt;/a&gt;. This can download a maximum of 100 samples continuously. Additional information is listed to highlight some interesting points about the sample, like the malware signature. It also can skip samples that have already been downloaded to save bandwidth.&lt;/p&gt;
&lt;p&gt;&lt;img alt="adding-automation-to-blue-jupyter-malware-notebook-01" src="https://www.accidentalrebel.com/images/adding-automation-to-blue-jupyter-malware-notebook-01.png" /&gt;&lt;/p&gt;
&lt;p&gt;The second significant addition is the automated generation of &lt;a href="https://github.com/mandiant/capa"&gt;Capa&lt;/a&gt; results for each downloaded sample. This makes it easy to see which malware has a particular capability so I can quickly see which ones are interesting enough to investigate further.&lt;/p&gt;
&lt;p&gt;&lt;img alt="adding-automation-to-blue-jupyter-malware-notebook-02" src="https://www.accidentalrebel.com/images/adding-automation-to-blue-jupyter-malware-notebook-02.png" /&gt;&lt;/p&gt;
&lt;p&gt;I also added minor improvements like error handling, additional logging for troubleshooting, and some cleanup code just in case I want to start fresh.&lt;/p&gt;
&lt;h1 id="check-it-out"&gt;Check it out&lt;/h1&gt;
&lt;p&gt;If you are interested in checking it out, you can view my fork of the repository &lt;a href="https://github.com/accidentalrebel/blue-jupyter/blob/main/malware-analysis/Malware-Analysis.ipynb"&gt;here&lt;/a&gt;. I did not request for a pull request on the original branch because I've changed a lot of things that the original owner might not prefer to have. Of course, I encourage everyone to fork what I made and make it their own. That's the beauty of Jupyter notebooks, anyway.&lt;/p&gt;</content><category term="malware"/><category term="malware"/><category term="re"/><category term="jupyter"/></entry><entry><title>Talking about Mitre's Malware Behavior Catalog</title><link href="https://www.accidentalrebel.com/talking-about-mitres-malware-behavior-catalog.html" rel="alternate"/><published>2022-08-02T15:06:00+08:00</published><updated>2022-08-02T15:06:00+08:00</updated><author><name>AccidentalRebel</name></author><id>tag:www.accidentalrebel.com,2022-08-02:/talking-about-mitres-malware-behavior-catalog.html</id><summary type="html">&lt;p&gt;I gave a 10-minute lightning talk at the recently concluded Blackhat Middle East &amp;amp; Africa community meetup. The topic is about Mitre's Malware Behavior Catalog (MBC) framework and the existing tools for it. My reason for selecting this topic is because I feel that more people should know about Mitre's not-so-well-known project.&lt;/p&gt;
&lt;p&gt;&lt;img alt="talking-about-mitres-malware-behavior-catalog-01" src="https://www.accidentalrebel.com/images/talking-about-mitres-malware-behavior-catalog-01.png" /&gt;&lt;/p&gt;
&lt;h2 id="a-brief-overview"&gt;A brief overview&lt;/h2&gt;
&lt;p&gt;MBC is a framework made by Mitre, similar to ATT&amp;amp;CK, but focuses on malware. It lists down the common objectives and behaviors commonly seen in malware. The purpose is to have standardize reporting so that everyone would use the same definitions when writing and talking about malware. This also aids with analysis and correlation with other tools.&lt;/p&gt;
&lt;p&gt;It has it's own matrix with malware objectives as headers for columns and an entry for each behavior. Each behavior then has a list of methods that explains how that behavior is achieved, example of malware that uses …&lt;/p&gt;</summary><content type="html">&lt;p&gt;I gave a 10-minute lightning talk at the recently concluded Blackhat Middle East &amp;amp; Africa community meetup. The topic is about Mitre's Malware Behavior Catalog (MBC) framework and the existing tools for it. My reason for selecting this topic is because I feel that more people should know about Mitre's not-so-well-known project.&lt;/p&gt;
&lt;p&gt;&lt;img alt="talking-about-mitres-malware-behavior-catalog-01" src="https://www.accidentalrebel.com/images/talking-about-mitres-malware-behavior-catalog-01.png" /&gt;&lt;/p&gt;
&lt;h2 id="a-brief-overview"&gt;A brief overview&lt;/h2&gt;
&lt;p&gt;MBC is a framework made by Mitre, similar to ATT&amp;amp;CK, but focuses on malware. It lists down the common objectives and behaviors commonly seen in malware. The purpose is to have standardize reporting so that everyone would use the same definitions when writing and talking about malware. This also aids with analysis and correlation with other tools.&lt;/p&gt;
&lt;p&gt;It has it's own matrix with malware objectives as headers for columns and an entry for each behavior. Each behavior then has a list of methods that explains how that behavior is achieved, example of malware that uses it, and also IDs of ATT&amp;amp;CK techniques related to the behavior.&lt;/p&gt;
&lt;p&gt;&lt;img alt="talking-about-mitres-malware-behavior-catalog-02" src="https://www.accidentalrebel.com/images/talking-about-mitres-malware-behavior-catalog-02.png" /&gt;&lt;/p&gt;
&lt;h2 id="the-tools"&gt;The tools&lt;/h2&gt;
&lt;p&gt;There are a number of existing tools that make use of MBC. &lt;a href="https://github.com/mandiant/capa"&gt;Flare's Capa&lt;/a&gt; lists down MBC along with the related ATT&amp;amp;CK techniques and there's also a repository of MBC community rules for the Cuckoo Sandox.&lt;/p&gt;
&lt;p&gt;I find MBC to have a lot of potential so I decided to contribute by making my own tool called &lt;a href="https://github.com/accidentalrebel/mbcscan"&gt;MBCScan&lt;/a&gt;. It's a simple tool that uses Capa which scans a supplied file and lists the MBC behaviors and objectives associated with it. It also allows you to explore the related information and relationships directly from the command line.&lt;/p&gt;
&lt;p&gt;&lt;img alt="talking-about-mitres-malware-behavior-catalog-03" src="https://www.accidentalrebel.com/images/talking-about-mitres-malware-behavior-catalog-03.png" /&gt;&lt;/p&gt;
&lt;h2 id="the-future"&gt;The future&lt;/h2&gt;
&lt;p&gt;MBC has been around for a number of years already but it still has not risen in popularity. In spite of this, it's still being continuously updated. I hope that by sharing and talking about it it'll help spread awareness and, hopefully, get some adoption.&lt;/p&gt;
&lt;p&gt;You can find more information about the project via this &lt;a href="https://www.youtube.com/watch?v=qZef-SoREdY"&gt;video presentation from Mitre&lt;/a&gt;. The Github project is &lt;a href="https://github.com/MBCProject"&gt;here&lt;/a&gt;. And the slides are available &lt;a href="https://docs.google.com/presentation/d/1w89wccaYr2g6104l73Xt2IUMGis_zgTB6krRC1q09Dw/edit?usp=sharing"&gt;here&lt;/a&gt;. &lt;/p&gt;</content><category term="malware"/><category term="malware"/><category term="analysis"/><category term="mitre"/><category term="mbc"/></entry><entry><title>Building my Virtual Cybersecurity Home Lab</title><link href="https://www.accidentalrebel.com/building-my-virtual-cybersecurity-home-lab.html" rel="alternate"/><published>2021-09-05T20:33:00+08:00</published><updated>2021-09-05T20:33:00+08:00</updated><author><name>AccidentalRebel</name></author><id>tag:www.accidentalrebel.com,2021-09-05:/building-my-virtual-cybersecurity-home-lab.html</id><summary type="html">&lt;p&gt;I have recently realized that one part of cybersecurity that I am lacking basic knowledge on is networking. I honestly did not think it was important when I was starting. It was the reason why I skipped Network+ so I could take Security+ directly. &lt;/p&gt;
&lt;p&gt;Now I know better.&lt;/p&gt;
&lt;p&gt;Ever since my realization, I have taken steps to patch the holes in my knowledge. I've started taking courses and bought books. But one thing that has made the most impact is me building my very own "homelab".&lt;/p&gt;
&lt;p&gt;I first came to know of the concept of homelabs &lt;a href="https://www.reddit.com/r/homelab/"&gt;from Reddit&lt;/a&gt;. To those unfamiliar, it is the practice of building a networked environment to gain practical knowledge in networking and IT. One way to do this is by making a virtual network.&lt;/p&gt;
&lt;p&gt;And so, over the past month, I have been building my very own virtual homelab with a focus on integrating cybersecurity …&lt;/p&gt;</summary><content type="html">&lt;p&gt;I have recently realized that one part of cybersecurity that I am lacking basic knowledge on is networking. I honestly did not think it was important when I was starting. It was the reason why I skipped Network+ so I could take Security+ directly. &lt;/p&gt;
&lt;p&gt;Now I know better.&lt;/p&gt;
&lt;p&gt;Ever since my realization, I have taken steps to patch the holes in my knowledge. I've started taking courses and bought books. But one thing that has made the most impact is me building my very own "homelab".&lt;/p&gt;
&lt;p&gt;I first came to know of the concept of homelabs &lt;a href="https://www.reddit.com/r/homelab/"&gt;from Reddit&lt;/a&gt;. To those unfamiliar, it is the practice of building a networked environment to gain practical knowledge in networking and IT. One way to do this is by making a virtual network.&lt;/p&gt;
&lt;p&gt;And so, over the past month, I have been building my very own virtual homelab with a focus on integrating cybersecurity products.&lt;/p&gt;
&lt;h1 id="the-lab"&gt;The Lab&lt;/h1&gt;
&lt;p&gt;The network diagram below shows the current implementation of my lab. I will be discussing each part to give an idea of their purpose (&lt;a href="https://www.accidentalrebel.com/images/building-my-virtual-cybersecurity-home-lab-00.png"&gt;Click here for a bigger version&lt;/a&gt;).&lt;/p&gt;
&lt;p&gt;&lt;img alt="building-my-virtual-cybersecurity-home-lab-01" src="https://www.accidentalrebel.com/images/building-my-virtual-cybersecurity-home-lab-01.png" /&gt;&lt;/p&gt;
&lt;p&gt;At the heart of the network is a firewall running &lt;a href="https://www.pfsense.org/"&gt;pfSense&lt;/a&gt;. Its purpose is to ensure that each sub-network is separated and protected, and also to protect my virtual host from any malware outbreaks. This machine also serves as a DHCP and NTP server to all the machines in the network.&lt;/p&gt;
&lt;p&gt;&lt;img alt="building-my-virtual-cybersecurity-home-lab-13" src="https://www.accidentalrebel.com/images/building-my-virtual-cybersecurity-home-lab-13.png" /&gt;&lt;/p&gt;
&lt;h1 id="the-target-network"&gt;The Target Network&lt;/h1&gt;
&lt;p&gt;On the right side of the diagram is the "Target" network where workstations and vulnerable servers reside. These are the machines that I use to attack with exploits and malware.&lt;/p&gt;
&lt;p&gt;&lt;img alt="building-my-virtual-cybersecurity-home-lab-02" src="https://www.accidentalrebel.com/images/building-my-virtual-cybersecurity-home-lab-02.png" /&gt;&lt;/p&gt;
&lt;p&gt;I have Metasploitable 2 and Metasploitable 3 machines that have various services turned on to play around with. I can learn about specific attacks by exploiting this machine, but I can also don my defenders hat and learn about how to secure them.&lt;/p&gt;
&lt;p&gt;The Windows and Linux machines will serve as typical workstations for various experiments.&lt;/p&gt;
&lt;p&gt;One of the perks of my job is that I get to play with different cybersecurity solutions. I currently have access to a few that I am able to use on my lab for testing.&lt;/p&gt;
&lt;p&gt;One solution that I am using right now is an EDR (Endpoint Detection and Response) (Sorry, I can't reveal which). Each machine has an EDR agent deployed which monitors for any malicious activities on the host. It has an anti-virus feature, anti-ransomware, and fileless attack monitoring. It's awesome stuff but I have yet to maximize this.&lt;/p&gt;
&lt;p&gt;An IDS (intrusion Detection System) running &lt;a href="https://www.snort.org/"&gt;Snort&lt;/a&gt; monitors the traffic for any malicious activity. Signatures are constantly updated to ensure that I can detect the latest types of attack. If it finds anything important, it then sends an alert to a SIEM (running &lt;a href="https://www.splunk.com/"&gt;Splunk&lt;/a&gt;) on the Management network.&lt;/p&gt;
&lt;p&gt;&lt;img alt="building-my-virtual-cybersecurity-home-lab-11" src="https://www.accidentalrebel.com/images/building-my-virtual-cybersecurity-home-lab-11.png" /&gt;&lt;/p&gt;
&lt;h1 id="the-management-network"&gt;The Management Network&lt;/h1&gt;
&lt;p&gt;On the left side of the diagram is the Managemnet network. This is where the management part of the EDR, IDS, and the SIEM can be accessed from my virtual host.&lt;/p&gt;
&lt;p&gt;&lt;img alt="building-my-virtual-cybersecurity-home-lab-03" src="https://www.accidentalrebel.com/images/building-my-virtual-cybersecurity-home-lab-03.png" /&gt;&lt;/p&gt;
&lt;p&gt;There's nothing special about this network, I do want to note though that I find it interesting the Snort IDS has two interfaces. One is used for access to the management page, and the other is for sniffing traffic on the Attacker network.&lt;/p&gt;
&lt;h1 id="the-operations-network"&gt;The Operations Network&lt;/h1&gt;
&lt;p&gt;At the bottom side of the diagram is the "Operations" network.&lt;/p&gt;
&lt;p&gt;A machine running Kali is placed here. I can launch attacks from this machine towards the vulnerable machines on the Target network. This machine also has OpenVAS scanner that helps in discovering vulnerabilities on the target machines.&lt;/p&gt;
&lt;p&gt;&lt;img alt="building-my-virtual-cybersecurity-home-lab-04" src="https://www.accidentalrebel.com/images/building-my-virtual-cybersecurity-home-lab-04.png" /&gt;&lt;/p&gt;
&lt;p&gt;A windows machine serves as my malware analysis lab. It contains a lot of malware analysis tools to aid with investigations. &lt;/p&gt;
&lt;p&gt;This machine is then connected to a &lt;a href="https://remnux.org/"&gt;Remnux&lt;/a&gt; Linux machine. All traffic from the Windows machine is port forwarded by Remnux. From here I can run Wireshark to inspect the traffic coming from the Windows malware lab and it can also spoof the network responses to influence the behavior of malware. If the Remnux machine is turned off, then the Windows machine is effectively cut off from the whole network. It's a really neat setup that &lt;a href="https://www.ariefprabowo.com/en/malware-analysis-en/personal-notes-building-a-malware-analysis-lab-environment/"&gt;I learned here&lt;/a&gt;.&lt;/p&gt;
&lt;h1 id="the-present"&gt;The Present&lt;/h1&gt;
&lt;p&gt;While the main intent of the network is to learn networking and implementing cybersecurity products, I can also investigate malware and learn about exploits by launching attacks. So it has a lot of multiple uses, which is perfect for someone like me who gets interested in different aspects of cybersecurity.&lt;/p&gt;
&lt;p&gt;My host machine currently has 32GB, 8 cores, and a total of 1.75TB which may seem a lot but is not powerful enough for all the machines to run at the same time. As a workaround, I just open the machines that I need for a particular exercise.&lt;/p&gt;
&lt;p&gt;&lt;img alt="building-my-virtual-cybersecurity-home-lab-05" src="https://www.accidentalrebel.com/images/building-my-virtual-cybersecurity-home-lab-05.png" /&gt;&lt;/p&gt;
&lt;p&gt;For example, if I want to investigate malware then I only need the firewall, Remnux, and the windows malware lab open. But if I want to attack and run an exploit, while making sure that it gets detected, then I need the firewall, EDR, IPS, SIEM, Kali, and the target machine to be open at the same time. This easily consumes around 20GB+!&lt;/p&gt;
&lt;h1 id="the-future"&gt;The Future&lt;/h1&gt;
&lt;p&gt;Working on this homelab has taught me a lot of practical knowledge. It helped solidify a lot of networking concepts I've learned througout the years.&lt;/p&gt;
&lt;p&gt;I'm not stopping here though. I also plan to upgrade the Target network so it would better resemble an enterprise network. For example, setting up an active directory, an internal DNS server, and maybe even a mail server (why not?). This is so I could play around in detecting and remediating more varied enterprise-level scenarios.&lt;/p&gt;
&lt;p&gt;I am also hoping I could get access to more cybersecurity products so I could play around with them. A SOAR (Security Orchestration and Response) would be a nice addition that would work really well.&lt;/p&gt;
&lt;p&gt;But, of course, before I could do any of the above I first need to upgrade my RAM and add more cores!&lt;/p&gt;</content><category term="malware"/><category term="malware"/><category term="dev"/></entry><entry><title>Making a RAT</title><link href="https://www.accidentalrebel.com/making-a-rat.html" rel="alternate"/><published>2021-07-13T14:56:00+08:00</published><updated>2021-07-13T14:56:00+08:00</updated><author><name>AccidentalRebel</name></author><id>tag:www.accidentalrebel.com,2021-07-13:/making-a-rat.html</id><summary type="html">&lt;p&gt;A Remote Access Tool (RAT) is used to remotely access a computer. It has legitimate uses but it can also be used for malicious purposes. I've seen it used in malware I've analyzed and I've always been curious as to how it works.&lt;/p&gt;
&lt;p&gt;I was following along the &lt;a href="https://handmadehero.org/"&gt;Handmade Hero project&lt;/a&gt; &lt;sup id="fnref:1"&gt;&lt;a class="footnote-ref" href="#fn:1"&gt;1&lt;/a&gt;&lt;/sup&gt; when the topic about dynamic DLL loading came up. This is a process of dynamically loading a DLL at runtime which is useful if you want your program to check if a DLL is present in a system before loading it.&lt;/p&gt;
&lt;p&gt;Two of the system calls that were discussed were LoadLibrary and GetProcAddress. These were familiar to me as I've seen them used on malware shellcode I analyzed in the past. I later learned that this is also used as an anti-virus evasion technique. I found this interesting.&lt;/p&gt;
&lt;p&gt;Having learned how to do runtime DLL loading myself I …&lt;/p&gt;</summary><content type="html">&lt;p&gt;A Remote Access Tool (RAT) is used to remotely access a computer. It has legitimate uses but it can also be used for malicious purposes. I've seen it used in malware I've analyzed and I've always been curious as to how it works.&lt;/p&gt;
&lt;p&gt;I was following along the &lt;a href="https://handmadehero.org/"&gt;Handmade Hero project&lt;/a&gt; &lt;sup id="fnref:1"&gt;&lt;a class="footnote-ref" href="#fn:1"&gt;1&lt;/a&gt;&lt;/sup&gt; when the topic about dynamic DLL loading came up. This is a process of dynamically loading a DLL at runtime which is useful if you want your program to check if a DLL is present in a system before loading it.&lt;/p&gt;
&lt;p&gt;Two of the system calls that were discussed were LoadLibrary and GetProcAddress. These were familiar to me as I've seen them used on malware shellcode I analyzed in the past. I later learned that this is also used as an anti-virus evasion technique. I found this interesting.&lt;/p&gt;
&lt;p&gt;Having learned how to do runtime DLL loading myself I decided to give it a try. And of course, a RAT is perfect for this.&lt;/p&gt;
&lt;p&gt;&lt;img alt="making-a-rat-01" src="https://www.accidentalrebel.com/images/making-a-rat-01.png" /&gt;&lt;/p&gt;
&lt;h2 id="planning-the-ratchitecture"&gt;Planning the RATchitecture&lt;/h2&gt;
&lt;p&gt;A lot of famous RATs are packed with features like the ability to log keystrokes, take screenshots, and turn on a webcam. I just want mine to be simple and have basic functionality like:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Execute command line commands remotely&lt;/li&gt;
&lt;li&gt;Download a file to the client&lt;/li&gt;
&lt;li&gt;Exfiltrate data via file upload&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;You can already do a lot of things even with the above basic functions. You can download a payload to the client, run it via remote command and then upload the results. You can even update the RAT itself using the same process!&lt;/p&gt;
&lt;p&gt;As an extra, I also wanted it to be stealthy. I am aware however that this is something that is not easily done. There are myriads of security defenses and I don't think I have the time and energy to have my RAT to be up-to-date with the latest evasion techniques. Having basic anti-debugging and anti-sandbox checks is enough for me.&lt;/p&gt;
&lt;p&gt;I've never made a RAT before but thankfully there are a lot of great resources online that helped me a lot:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://github.com/quantumcore/paradoxiaRAT"&gt;ParadoxiaRat&lt;/a&gt; is my main resource and has done a lot of the features I wanted to implement.&lt;/li&gt;
&lt;li&gt;&lt;a href="https://github.com/yatt-ze/The-Collection/tree/master/Source%20Codes/Botnets/DarkRat%20Loader/derkrut"&gt;DarkRAT&lt;/a&gt; is a leaked source code that gave me an idea of how a RAT used in the wild looks like&lt;/li&gt;
&lt;li&gt;&lt;a href="https://github.com/vxunderground/WinAPI-Tricks"&gt;VXUnderground's WinAPI tricks&lt;/a&gt; taught me that there are alternative ways to do certain things to avoid detection&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;As for the name of the project, I decided on "RATwurst" after the german sausage, Bratwurst. Don't ask me why. I just thought it's funny that it had the letters RAT in it.&lt;/p&gt;
&lt;p&gt;&lt;img alt="making-a-rat-02" src="https://www.accidentalrebel.com/images/making-a-rat-02.png" /&gt;&lt;/p&gt;
&lt;h2 id="the-nitty-gratty-details"&gt;The nitty gRATty details&lt;/h2&gt;
&lt;p&gt;The client is written in ANSI C because it's the language I prefer. Since I am only targeting Windows I chose MSVC for the compiler. Which is great because it allows me to use Visual Studio for debugging.&lt;/p&gt;
&lt;p&gt;The server, on the other hand, is written in Python because I wanted another excuse to practice with it. Choosing Python has been a good choice though because of the excellent low level &lt;a href="https://docs.python.org/3/library/socket.html"&gt;socket&lt;/a&gt; and &lt;a href="https://docs.python.org/3/library/cmd.html"&gt;cmd&lt;/a&gt; libraries.&lt;/p&gt;
&lt;p&gt;Sockets are used for communication between client and server. I've applied basic XOR obfuscation to the data to mask the traffic. The client and server can handle sending of strings and even executables over the network.&lt;/p&gt;
&lt;p&gt;When RATwurst is first executed. It does some anti-sandbox checks via process enumeration. It checks if there are more than 15 processe that are running and if there are virtualization tools present like &lt;code&gt;vmware.exe&lt;/code&gt;. It will also setup an auto-run registry entry for persistence. And also move the executable to Windows' temp folder and re-run it from there.&lt;/p&gt;
&lt;p&gt;Anti-debbuging checks are littered throughout the code which checks the amount of time it takes to reach from one part of the code to the next. This is used to detect if someone is stepping through the code, increasing the delay between code execution.&lt;/p&gt;
&lt;p&gt;When no shenanigans is detected then it'll proceed to work as intended. &lt;/p&gt;
&lt;p&gt;&lt;img alt="making-a-rat-02" src="https://www.accidentalrebel.com/images/making-a-rat-02.png" /&gt;&lt;/p&gt;
&lt;h2 id="for-edurational-purposes-only"&gt;For eduRATional purposes only&lt;/h2&gt;
&lt;p&gt;I've made the source of my project &lt;a href="https://github.com/accidentalrebel/ratwurst"&gt;available on Github&lt;/a&gt;. The aim is to share what I've learned so that others can learn too.&lt;/p&gt;
&lt;p&gt;I am aware of news of RAT authors having been arrested because of their work. They actively sought to gain money from their creation, I, of course, have no such plans.&lt;/p&gt;
&lt;p&gt;To make sure that I save myself from any legal problems, I've placed a disclaimer that I am not responsible for any misuse. While I am skeptical that a piece of text would prevent any legal action towards me, I do see other projects having their own disclaimers so I decided to do the same.&lt;/p&gt;
&lt;p&gt;I've also submitted my creation to a multi-scanner service like VirusTotal. This would help distribute my RATs signature to anti-virus companies so it can easily be detected when used in the wild.&lt;sup id="fnref:2"&gt;&lt;a class="footnote-ref" href="#fn:2"&gt;2&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;
&lt;h2 id="a-ratisfying-learning-experience"&gt;A RATisfying learning experience&lt;/h2&gt;
&lt;p&gt;Making this project has been a lot of fun. &lt;/p&gt;
&lt;p&gt;The most useful thing that I learned is the client and server communication via sockets. I've dabbled with it before but only in this project have I actually sent actual data back and forth.&lt;/p&gt;
&lt;p&gt;I am also happy that I got to use more Windows APIs. It's fun to play around with what's available and it is opening my mind as to what other things I can make in the future.&lt;/p&gt;
&lt;p&gt;And of course, this project has given me a good insight into the techniques used by malware. Learning about them is not enough until you've built one yourself.&lt;/p&gt;
&lt;div class="footnote"&gt;
&lt;hr /&gt;
&lt;ol&gt;
&lt;li id="fn:1"&gt;
&lt;p&gt;Handmade here is a project by Casey Muratori where a game is created from scratch live on stream, has been going on for 6+ years, it's awesome&amp;#160;&lt;a class="footnote-backref" href="#fnref:1" title="Jump back to footnote 1 in the text"&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li id="fn:2"&gt;
&lt;p&gt;Multi-scanners help to easily distribute virus signatures to security services. An opposite to this are "no-distribute" sacnners. More info about this &lt;a href="https://www.bleepingcomputer.com/news/security/75-percent-of-malware-uploaded-on-no-distribute-scanners-is-unknown-to-researchers/"&gt;here&lt;/a&gt;.&amp;#160;&lt;a class="footnote-backref" href="#fnref:2" title="Jump back to footnote 2 in the text"&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;</content><category term="malware"/><category term="malware"/><category term="dev"/></entry></feed>