<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AccidentalRebel.com</title>

    <meta name="description" content="SOC leader and content engineer at TryHackMe. Writing about AI, security tools, malware analysis, and reverse engineering.">

    <link rel="canonical" href="./">

    <link href="https://www.accidentalrebel.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="AccidentalRebel.com Atom Feed" />

    <link rel="stylesheet" href="./theme/css/main.css">

    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "Person",
        "name": "AccidentalRebel",
        "url": ".",
        "sameAs": ["https://www.linkedin.com/in/juan-karlo-licudine/", "https://github.com/accidentalrebel"]
    }
    </script>

</head>
<body>
    <div class="rebel-stripe"></div>
    <div class="progress-bar" id="progress"></div>

    <header>
        <div class="container-wide">
            <nav>
                <a href="./" class="site-title">Accidental<span class="rebel">Rebel</span>.com</a>
                <button class="menu-toggle" onclick="toggleMenu()">☰</button>
                <ul class="nav-links" id="navLinks">
                    <li><a href="./archives.html">Archives</a></li>
                    <li><a href="./categories.html">Categories</a></li>
                    <li><a href="./tags.html">Tags</a></li>
                            <li><a href="./category/cybersecurity-x-ai-news-roundup.html">Newsletter</a></li>
                            <li><a href="./pages/about.html">About</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <main>
        <div class="container-wide">
            <div class="layout">
                <div class="content">
    <article class="post-item">
        <header class="article-header">
            <a href="./category/malware.html" class="article-category-label">malware</a>
            <h2 class="post-title">
                <a href="./making-a-rat.html">Making a RAT</a>
            </h2>
            <div class="article-meta">
                <time datetime="2021-07-13T14:56:00+08:00">Tue 13 July 2021</time>
            </div>
        </header>

        <div class="article-content">
            <p>A Remote Access Tool (RAT) is used to remotely access a computer. It has legitimate uses but it can also be used for malicious purposes. I've seen it used in malware I've analyzed and I've always been curious as to how it works.</p>
<p>I was following along the <a href="https://handmadehero.org/">Handmade Hero project</a> <sup id="fnref:1"><a class="footnote-ref" href="#fn:1">1</a></sup> when the topic about dynamic DLL loading came up. This is a process of dynamically loading a DLL at runtime which is useful if you want your program to check if a DLL is present in a system before loading it.</p>
<p>Two of the system calls that were discussed were LoadLibrary and GetProcAddress. These were familiar to me as I've seen them used on malware shellcode I analyzed in the past. I later learned that this is also used as an anti-virus evasion technique. I found this interesting.</p>
<p>Having learned how to do runtime DLL loading myself I …</p>
            <a href="./making-a-rat.html" class="read-more">Read more &rarr;</a>
        </div>

        <div class="tags">
            <a href="./tag/malware.html" class="tag">malware</a>
            <a href="./tag/dev.html" class="tag">dev</a>
        </div>
    </article>
    <article class="post-item">
        <header class="article-header">
            <a href="./category/security.html" class="article-category-label">security</a>
            <h2 class="post-title">
                <a href="./finding-phished-passwords-on-a-scam-site.html">Finding phished passwords on a scam site</a>
            </h2>
            <div class="article-meta">
                <time datetime="2021-05-01T20:56:00+08:00">Sat 01 May 2021</time>
            </div>
        </header>

        <div class="article-content">
            <p>Since my last post about <a href="investigating-an-fb-phishing-site">my investigations of a Facebook phishing site</a>, I have received several messages from friends asking me to check out other suspected phishing/scam sites. One of the most alarming out of them was this one where I was able to find the file where the scammer stores the phished usernames and passwords.</p>
<p><img alt="finding-phished-passwords-from-a-scam-site-01" src="./images/finding-phished-passwords-from-a-scam-site-01.png" /></p>
<p>This particular phishing site conducts its operations like this:</p>
<ul>
<li>An ad is shown on Facebook, promising free coupons for famous fast food restaurants</li>
<li>Clicking on the ad takes the user to a fake Facebook login page hosted on <em>blogger.com</em></li>
<li>Login page then sends phished username and passwords to a PHP file hosted on <em>000webhost</em></li>
</ul>
<p>The phished passwords are then stored in a <code>.txt</code> file (blatantly named, <code>victims.txt</code>), which is publicly accessible on an open directory. Getting to this directory involved following the scripts and the URLs used by the scammers. It's …</p>
            <a href="./finding-phished-passwords-on-a-scam-site.html" class="read-more">Read more &rarr;</a>
        </div>

        <div class="tags">
            <a href="./tag/phishing.html" class="tag">phishing</a>
            <a href="./tag/threat-hunting.html" class="tag">threat-hunting</a>
            <a href="./tag/osint.html" class="tag">osint</a>
        </div>
    </article>
    <article class="post-item">
        <header class="article-header">
            <a href="./category/ctf.html" class="article-category-label">ctf</a>
            <h2 class="post-title">
                <a href="./emprisa-maldoc-writeup..html">Emprisa Maldoc Writeup</a>
            </h2>
            <div class="article-meta">
                <time datetime="2021-04-30T05:58:00+08:00">Fri 30 April 2021</time>
            </div>
        </header>

        <div class="article-content">
            <blockquote>
<p>This is a writeup for <a href="the-emprisa-maldoc-challenge">Emprisa maldoc challenge</a> that I made for <a href="https://cyberdefenders.org/">CyberDefenders.org</a>. You can play it <a href="https://cyberdefenders.org/labs/56">here</a>.</p>
</blockquote>
<p>The very first thing that I do when confronted with a malicious document is to run it in a malware lab. This particular document, however, would not exhibit anything malicious on recent versions of Word.</p>
<p>A quick search of the hash on malware sandboxes would reveal that the document makes use of the <a href="https://nvd.nist.gov/vuln/detail/CVE-2017-18822">CVE-2017-18822 vulnerability</a>. This is a vulnerability that became known and was promptly patched around November of 2017.</p>
<p>The above details give us a hint on how to trigger the document, which is to run the maldoc on a version of Microsoft Word that doesn't have the patches that fix the vulnerability. The easiest way to do this is to boot up a new VM with a fresh install of Windows 7 and with updates disabled.</p>
<p>This new environment …</p>
            <a href="./emprisa-maldoc-writeup..html" class="read-more">Read more &rarr;</a>
        </div>

        <div class="tags">
            <a href="./tag/maldoc.html" class="tag">maldoc</a>
            <a href="./tag/writeup.html" class="tag">writeup</a>
        </div>
    </article>
    <article class="post-item">
        <header class="article-header">
            <a href="./category/security.html" class="article-category-label">security</a>
            <h2 class="post-title">
                <a href="./investigating-an-fb-phishing-site.html">Investigating an FB phishing site</a>
            </h2>
            <div class="article-meta">
                <time datetime="2021-04-24T05:58:00+08:00">Sat 24 April 2021</time>
            </div>
        </header>

        <div class="article-content">
            <p>Last April 21, people were posting warnings about a suspicious Facebook post where your account will supposedly get hacked when you click it. From the discussions, I gathered that it is a classic phishing site scam. A very effective one too, because as soon as an account gets compromised the attacker logs in and tags the friends in the account allowing it to spread further. The news of this got big that even the PH CERT issued <a href="https://www.facebook.com/Ncertgovph/posts/1879686332199270">a security advisory on it</a>.</p>
<p><img alt="checking-the-fb-phishing-site-02" src="./images/checking-the-fb-phishing-site-02.jpg" /></p>
<h1 id="i-was-just-curious-i-swear">I was just curious, I swear!</h1>
<p>I wanted to see the phishing site for myself but I was unlucky and did not get tagged by anyone. So I reached out to people who did and I eventually got to this page shown below:</p>
<p><img alt="checking-the-fb-phishing-site-01" src="./images/checking-the-fb-phishing-site-01.png" /></p>
<p>To a trained eye, one could easily see the obvious red flags. But how can one notice them if there is a very attention-catching image …</p>
            <a href="./investigating-an-fb-phishing-site.html" class="read-more">Read more &rarr;</a>
        </div>

        <div class="tags">
            <a href="./tag/phishing.html" class="tag">phishing</a>
            <a href="./tag/threat-hunting.html" class="tag">threat-hunting</a>
            <a href="./tag/osint.html" class="tag">osint</a>
        </div>
    </article>
    <article class="post-item">
        <header class="article-header">
            <a href="./category/ctf.html" class="article-category-label">ctf</a>
            <h2 class="post-title">
                <a href="./the-emprisa-maldoc-challenge.html">The Emprisa Maldoc Challenge</a>
            </h2>
            <div class="article-meta">
                <time datetime="2021-04-04T16:37:00+08:00">Sun 04 April 2021</time>
            </div>
        </header>

        <div class="article-content">
            <p>I was inspired to make my own CTF challenge after finishing <a href="./maldoc101-writeup-part-1.html">Maldoc101</a> found at <a href="https://cyberdefenders.org/">Cyberdefenders.org</a>. The challenge I made is called <a href="https://cyberdefenders.org/labs/56">Emprisa Maldoc</a> and it is now up on their website. </p>
<p>Emprisa is based on a malicious document that I downloaded blindly from a malware sandbox. It used a relatively old but still interesting exploit that is still in use today. After researching more about it I came across a tool that can generate a malicious doc using the same exact exploit. This is when I got the idea to turn it into a challenge.</p>
<p><img alt="the-emprisa-maldoc-challenge-01" src="./images/the-emprisa-maldoc-challenge-01.png" /></p>
<p>The challenge has 14 questions with increasing and varying difficulty. The challenge is targeted towards intermediate analysts who already have experience examining maldocs before. The goal is to reinforce the use of common malware analysis tools, but at the same time, teach players new things and techniques. It involves flexing muscles related to open …</p>
            <a href="./the-emprisa-maldoc-challenge.html" class="read-more">Read more &rarr;</a>
        </div>

        <div class="tags">
            <a href="./tag/maldoc.html" class="tag">maldoc</a>
            <a href="./tag/ctf.html" class="tag">ctf</a>
        </div>
    </article>
    <article class="post-item">
        <header class="article-header">
            <a href="./category/re.html" class="article-category-label">re</a>
            <h2 class="post-title">
                <a href="./ioli-crackme-0x03.html">IOLI Crackme 0x03</a>
            </h2>
            <div class="article-meta">
                <time datetime="2021-03-22T20:03:00+08:00">Mon 22 March 2021</time>
            </div>
        </header>

        <div class="article-content">
            <p>I am continuing my reverse engineering review by tackling the <em>IOLI crackmes</em> by <a href="https://twitter.com/pof">@pof</a>. These are beginner friendly challenges that is perfect for newbies or for those who want to review the basics like me. Check out my writeups for <a href="./ioli-crackme-0x00.html">0x00</a>, <a href="./ioli-crackme-0x01.html">0x01</a>, and <a href="./ioli-crackme-0x02.html">0x02</a>.</p>
<h1 id="getting-the-password">Getting the password</h1>
<p>After opening the program in IDA I immediately saw that the code is almost exactly as the one in challenge <a href="./ioli-crackme-0x02.html">0x02</a>, with the exception of our expected <code>cmp</code> command being inside the <code>_test</code> function.</p>
<p><img alt="ioli-crackme-0x03-01" src="./images/ioli-crackme-0x03-01.png" /></p>
<p>Reading through the code I realized that the password for this challenge is exactly the same as the previous one!</p>
<p>But what's this? The success and failure messages are all garbled? And plus, what is this other new function called <code>_shift</code>?</p>
<p><img alt="ioli-crackme-0x03-02" src="./images/ioli-crackme-0x03-02.png" /></p>
<h1 id="a-different-kind-of-challenge">A different kind of challenge</h1>
<p>Opening up the <code>_shift</code> function shows us a short, but interesting looking program flow with two branches and one of the branches looping …</p>
            <a href="./ioli-crackme-0x03.html" class="read-more">Read more &rarr;</a>
        </div>

        <div class="tags">
            <a href="./tag/re.html" class="tag">re</a>
            <a href="./tag/crackme.html" class="tag">crackme</a>
        </div>
    </article>
    <article class="post-item">
        <header class="article-header">
            <a href="./category/malware_analysis.html" class="article-category-label">malware_analysis</a>
            <h2 class="post-title">
                <a href="./maldoc101-writeup-part-2.html">Maldoc101 Writeup (Part 2)</a>
            </h2>
            <div class="article-meta">
                <time datetime="2021-03-14T08:34:00+08:00">Sun 14 March 2021</time>
            </div>
        </header>

        <div class="article-content">
            <p>This is part 2 of my writeup for the Maldoc101 challenge. Check out <a href="./maldoc101-writeup-part-1.html">part 1</a> for the beginning of the analysis.</p>
<p>The next couple of lines does the same concatenating technique similar to the previous steps. </p>
<div class="codehilite"><pre><span></span><code>deaknaugthein = roubhaol.kaizseah.ControlTipText
giakfeiw = deulsaocthuul + gooykadheoj + roubhaol.paerwagyouqumeid.ControlTipText + deaknaugthein
queegthaen = giakfeiw + roubhaol.joefwoefcheaw
</code></pre></div>

<p>At the end of the code above <code>queegthaen</code> now contains the value <code>Win32_Process</code> + <code>s</code> + <code>tar</code> + <code>tu</code> + <code>P</code>. Or when combined creates the string <code>Win32_ProcessstartuP</code> which probably refers <a href="https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-processstartup">to this WMI class</a> in the Microsoft docs.</p>
<p><em>Note: This writeup appears to be incomplete. For the complete analysis, please refer to <a href="./maldoc101-writeup-part-1.html">part 1</a> of this series.</em></p>
            <a href="./maldoc101-writeup-part-2.html" class="read-more">Read more &rarr;</a>
        </div>

        <div class="tags">
            <a href="./tag/re.html" class="tag">re</a>
            <a href="./tag/malware_analysis.html" class="tag">malware_analysis</a>
            <a href="./tag/malware.html" class="tag">malware</a>
        </div>
    </article>
    <article class="post-item">
        <header class="article-header">
            <a href="./category/malware_analysis.html" class="article-category-label">malware_analysis</a>
            <h2 class="post-title">
                <a href="./maldoc101-writeup-part-1.html">Maldoc101 Writeup (Part 1)</a>
            </h2>
            <div class="article-meta">
                <time datetime="2021-03-13T08:34:00+08:00">Sat 13 March 2021</time>
            </div>
        </header>

        <div class="article-content">
            <p>This is part 1 out of 2 of my writeup for the Maldoc101 challenge made by Josh Stroschein (<a href="https://twitter.com/jstrosch">@jstrosch</a>) and is currently playable at <a href="https://cyberdefenders.org/labs/51">Cyberdefenders.Org</a>. I've done some maldoc analysis before but this is the first time I'm writing about my approach.</p>
<p>There is also an already existing writeup about this challenge <a href="https://github.com/jstrosch/malware-samples/blob/master/malware_analysis_exercises/2020/December/solution.md">from the creator himself</a>. You should check that out if you want a more detailed and focused writeup. This writeup is more from the perspective of someone relatively new to malware analysis. There's a lot more exploration and trial-and-error which, I hope, might give the reader a different view in how this kind of problem is approached.</p>
<h2 id="the-challenge">The challenge</h2>
<h3 id="name">Name</h3>
<p><a href="https://cyberdefenders.org/labs/51">MalDoc101 - Malicious Document</a></p>
<h3 id="description">Description</h3>
<p>It is common for threat actors to utilize living off the land (LOTL) techniques, such as the execution of PowerShell to further their attacks and transition from macro code. This challenge is intended …</p>
            <a href="./maldoc101-writeup-part-1.html" class="read-more">Read more &rarr;</a>
        </div>

        <div class="tags">
            <a href="./tag/re.html" class="tag">re</a>
            <a href="./tag/malware_analysis.html" class="tag">malware_analysis</a>
            <a href="./tag/malware.html" class="tag">malware</a>
        </div>
    </article>
    <article class="post-item">
        <header class="article-header">
            <a href="./category/re.html" class="article-category-label">re</a>
            <h2 class="post-title">
                <a href="./ioli-crackme-0x02.html">IOLI Crackme 0x02</a>
            </h2>
            <div class="article-meta">
                <time datetime="2021-03-06T10:34:00+08:00">Sat 06 March 2021</time>
            </div>
        </header>

        <div class="article-content">
            <p>I am continuing my reverse engineering review by tackling the <em>IOLI crackmes</em> by <a href="https://twitter.com/pof">@pof</a>. These are beginner friendly challenges that is perfect for newbies or for those who want to review the basics like me. Check out my writeups for <a href="./ioli-crackme-0x00.html">0x00</a> and <a href="./ioli-crackme-0x01.html">0x01</a>.</p>
<h1 id="getting-the-password">Getting the password</h1>
<p>After the first two challenges I kinda know what to expect already so I skipped running the program and immediately loaded it in IDA.</p>
<p><img alt="ioli-crackme-0x02-01" src="./images/ioli-crackme-0x02-01.png" /></p>
<p>So the lines leading to the comparison command now looks more complicated than before. We could easily see that there are some computations that happens thanks to the presence of <code>add</code> and <code>imul</code>. Before those, we have two values (<code>5Ah</code> and <code>1ECh</code>) which we can easily guess are the values that will be worked on by these arithmetic functions.</p>
<p>So going through the lines sequentially we can see that the two numbers are first added with <code>add [eax], edx</code>. Which …</p>
            <a href="./ioli-crackme-0x02.html" class="read-more">Read more &rarr;</a>
        </div>

        <div class="tags">
            <a href="./tag/re.html" class="tag">re</a>
            <a href="./tag/crackme.html" class="tag">crackme</a>
        </div>
    </article>
    <article class="post-item">
        <header class="article-header">
            <a href="./category/tools.html" class="article-category-label">tools</a>
            <h2 class="post-title">
                <a href="./introducing-shcode2exe.html">Introducing shcode2exe</a>
            </h2>
            <div class="article-meta">
                <time datetime="2021-02-26T07:34:00+08:00">Fri 26 February 2021</time>
            </div>
        </header>

        <div class="article-content">
            <p><strong>[Edit: shcode2exe is <a href="https://docs.remnux.org/discover-the-tools/dynamically+reverse-engineer+code/shellcode#shcode-2-exe">now part of Remnux</a>]</strong></p>
<p>I've been playing around with <a href="https://remnux.org/">Remnux</a> and encountered a problem trying to get one of the tools to run properly. The tool is <a href="https://github.com/repnz/shellcode2exe">shellcode2exe</a>, it is used to compile binary shellcode to a file so it can easily be debugged by a debugger.</p>
<p>When I checked out the code, I was surprised to find out how simple it is. Basically, what happens is that the inputted shellcode is added to a barebones assembly file using the <code>incbin</code> assembly instruction. From there, the file is then automatically compiled and linked.</p>
<p>One big problem with the tool is that it needs to use <a href="https://www.winehq.org/">Wine</a> if it needs to run on Linux. I don't want such a huge dependency especially for my own malware analysis lab so I decided to write my own version which have led to the creation of <code>shcode2exe</code>.</p>
<h2 id="shcode2exe">shcode2exe</h2>
<p>While similar in …</p>
            <a href="./introducing-shcode2exe.html" class="read-more">Read more &rarr;</a>
        </div>

        <div class="tags">
            <a href="./tag/re.html" class="tag">re</a>
            <a href="./tag/tools.html" class="tag">tools</a>
            <a href="./tag/malware_analysis.html" class="tag">malware_analysis</a>
        </div>
    </article>

<nav class="pagination">
        <a href="./index2.html">&laquo; Previous</a>

        <a href="./index.html">1</a>
        <a href="./index2.html">2</a>
        <span class="current">3</span>
        <a href="./index4.html">4</a>
        <a href="./index5.html">5</a>

    <a href="./index4.html">Next &raquo;</a>
</nav>
                </div>
                <aside class="sidebar">
                    <div class="sidebar-sticky">
                        <img src="./theme/images/avatar.png" alt="AccidentalRebel" class="sidebar-avatar">
                        <h3 class="sidebar-name">AccidentalRebel</h3>
                        <p class="sidebar-realname">Juan Karlo Licudine</p>
                        <p class="sidebar-bio">SOC leader and content engineer at TryHackMe. Writing about AI, security tools, malware analysis, and reverse engineering.</p>
                        <ul class="sidebar-social">
                            <li><a href="https://www.linkedin.com/in/juan-karlo-licudine/" target="_blank" rel="noopener">LinkedIn</a></li>
                            <li><a href="https://github.com/accidentalrebel" target="_blank" rel="noopener">GitHub</a></li>
                        </ul>
                    </div>
                </aside>
            </div>
        </div>
    </main>

    <footer class="site-footer">
        <div class="container-wide">
            <div class="footer-content">
                <span>&copy; AccidentalRebel. SOC leader and content engineer at TryHackMe. Writing about AI, security tools, malware analysis, and reverse engineering.</span>
                <ul class="footer-links">
                    <li><a href="https://www.linkedin.com/in/juan-karlo-licudine/" target="_blank" rel="noopener">LinkedIn</a></li>
                    <li><a href="https://github.com/accidentalrebel" target="_blank" rel="noopener">GitHub</a></li>
                </ul>
            </div>
        </div>
    </footer>

    <script src="./theme/js/main.js"></script>

    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-55068085-2"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'UA-55068085-2');
    </script>
</body>
</html>