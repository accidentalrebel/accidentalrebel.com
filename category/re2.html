<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>re | AccidentalRebel.com</title>
    
    <link href="https://www.accidentalrebel.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="AccidentalRebel.com Atom Feed" />
    
    <link rel="stylesheet" href="../theme/css/main.css">
    
</head>
<body>
    <div class="progress-bar" id="progress"></div>
    
    <header>
        <div class="container">
            <nav>
                <a href="../" class="site-title">AccidentalRebel.com</a>
                <button class="menu-toggle" onclick="toggleMenu()">☰</button>
                <ul class="nav-links" id="navLinks">
                    <li><a href="../archives.html">Archives</a></li>
                    <li><a href="../categories.html">Categories</a></li>
                    <li><a href="../tags.html">Tags</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <!-- Comic strip divider -->
    <div class="comic-container">
        <div class="comic-strip"></div>
    </div>

    <main>
        <div class="container">
<article>
    <header class="article-header">
        <h1>Category: re</h1>
    </header>

    <div class="article-content">
        <div class="post-item">
            <h2 class="post-title">
                <a href="../ioli-crackme-0x04.html">IOLI Crackme 0x04</a>
            </h2>
            <div class="article-meta">
                <time datetime="2021-09-29T10:34:00+08:00">Wed 29 September 2021</time>
            </div>
            <div class="post-summary">
                <p>I am continuing my reverse engineering review by tackling the <em>IOLI crackmes</em> by <a href="https://twitter.com/pof">@pof</a>. These are beginner friendly challenges that is perfect for newbies or for those who want to review the basics like me. Check out my writeups for <a href="../ioli-crackme-0x00.html">0x00</a>, <a href="../ioli-crackme-0x01.html">0x01</a>, <a href="../ioli-crackme-0x02.html">0x02</a>, and <a href="../ioli-crackme-0x03.html">0x03</a>.</p>
<h1 id="getting-the-password">Getting the password</h1>
<p>Loading the program in IDA revealed something new. There is now a <code>_check</code> function that when opened looks more complicated than the previous challenges.</p>
<p><img alt="ioli-crackme-0x04-01" src="../images/ioli-crackme-0x04-01.png" /></p>
<p>The one thing that I immediately noticed is the call to the <code>_strlen</code> function similar to the previous challenge. This means that the length of the input string plays another important role.</p>
<p>One curious thing is the condition that leads to the "Password Incorrect" block, as shown below.</p>
<p><img alt="ioli-crackme-0x04-02" src="../images/ioli-crackme-0x04-02.png" /></p>
<div class="codehilite"><pre><span></span><code><span class="nf">call</span><span class="w"> </span><span class="no">_strlen</span>
<span class="nf">cmp</span><span class="w"> </span><span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">var_C</span><span class="p">],</span><span class="w"> </span><span class="no">eax</span>
<span class="nf">jnb</span><span class="w"> </span><span class="no">short</span><span class="w"> </span><span class="no">loc_401387</span>
</code></pre></div>

<p>From the looks of it, the check will fail if <code>var_C</code> (Which is our <code>var_counter</code> from the previous challenge) reaches the …</p>
            </div>
            <div class="tags">
                <a href="../tag/re.html" class="tag">re</a>
                <a href="../tag/crackme.html" class="tag">crackme</a>
            </div>
        </div>
        <div class="post-item">
            <h2 class="post-title">
                <a href="../ioli-crackme-0x03.html">IOLI Crackme 0x03</a>
            </h2>
            <div class="article-meta">
                <time datetime="2021-03-22T20:03:00+08:00">Mon 22 March 2021</time>
            </div>
            <div class="post-summary">
                <p>I am continuing my reverse engineering review by tackling the <em>IOLI crackmes</em> by <a href="https://twitter.com/pof">@pof</a>. These are beginner friendly challenges that is perfect for newbies or for those who want to review the basics like me. Check out my writeups for <a href="../ioli-crackme-0x00.html">0x00</a>, <a href="../ioli-crackme-0x01.html">0x01</a>, and <a href="../ioli-crackme-0x02.html">0x02</a>.</p>
<h1 id="getting-the-password">Getting the password</h1>
<p>After opening the program in IDA I immediately saw that the code is almost exactly as the one in challenge <a href="../ioli-crackme-0x02.html">0x02</a>, with the exception of our expected <code>cmp</code> command being inside the <code>_test</code> function.</p>
<p><img alt="ioli-crackme-0x03-01" src="../images/ioli-crackme-0x03-01.png" /></p>
<p>Reading through the code I realized that the password for this challenge is exactly the same as the previous one!</p>
<p>But what's this? The success and failure messages are all garbled? And plus, what is this other new function called <code>_shift</code>?</p>
<p><img alt="ioli-crackme-0x03-02" src="../images/ioli-crackme-0x03-02.png" /></p>
<h1 id="a-different-kind-of-challenge">A different kind of challenge</h1>
<p>Opening up the <code>_shift</code> function shows us a short, but interesting looking program flow with two branches and one of the branches looping …</p>
            </div>
            <div class="tags">
                <a href="../tag/re.html" class="tag">re</a>
                <a href="../tag/crackme.html" class="tag">crackme</a>
            </div>
        </div>
        <div class="post-item">
            <h2 class="post-title">
                <a href="../ioli-crackme-0x02.html">IOLI Crackme 0x02</a>
            </h2>
            <div class="article-meta">
                <time datetime="2021-03-06T10:34:00+08:00">Sat 06 March 2021</time>
            </div>
            <div class="post-summary">
                <p>I am continuing my reverse engineering review by tackling the <em>IOLI crackmes</em> by <a href="https://twitter.com/pof">@pof</a>. These are beginner friendly challenges that is perfect for newbies or for those who want to review the basics like me. Check out my writeups for <a href="../ioli-crackme-0x00.html">0x00</a> and <a href="../ioli-crackme-0x01.html">0x01</a>.</p>
<h1 id="getting-the-password">Getting the password</h1>
<p>After the first two challenges I kinda know what to expect already so I skipped running the program and immediately loaded it in IDA.</p>
<p><img alt="ioli-crackme-0x02-01" src="../images/ioli-crackme-0x02-01.png" /></p>
<p>So the lines leading to the comparison command now looks more complicated than before. We could easily see that there are some computations that happens thanks to the presence of <code>add</code> and <code>imul</code>. Before those, we have two values (<code>5Ah</code> and <code>1ECh</code>) which we can easily guess are the values that will be worked on by these arithmetic functions.</p>
<p>So going through the lines sequentially we can see that the two numbers are first added with <code>add [eax], edx</code>. Which …</p>
            </div>
            <div class="tags">
                <a href="../tag/re.html" class="tag">re</a>
                <a href="../tag/crackme.html" class="tag">crackme</a>
            </div>
        </div>
        <div class="post-item">
            <h2 class="post-title">
                <a href="../ioli-crackme-0x01.html">IOLI Crackme 0x01</a>
            </h2>
            <div class="article-meta">
                <time datetime="2021-02-20T17:34:00+08:00">Sat 20 February 2021</time>
            </div>
            <div class="post-summary">
                <p>I am continuing my reverse engineering review by tackling the <em>IOLI crackmes</em> by <a href="https://twitter.com/pof">@pof</a>. These are beginner friendly challenges that is perfect for newbies or for those who want to review the basics like me. Check out my writeup for 0x00 <a href="../ioli-crackme-0x00.html">here</a>.</p>
<h1 id="getting-the-password">Getting the password</h1>
<p>Of course, the first thing we do is run the program.</p>
<p><img alt="ioli-crackme-0x01-01" src="../images/ioli-crackme-0x01-01.png" /></p>
<p>Just like last time, we opened up the program in IDA and focused on the part of the code that does the comparing of passwords.</p>
<p><img alt="ioli-crackme-0x01-02" src="../images/ioli-crackme-0x01-02.png" /></p>
<div class="codehilite"><pre><span></span><code><span class="nf">cmp</span><span class="w"> </span><span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">var_4</span><span class="p">],</span><span class="w"> </span><span class="mi">149</span><span class="no">Ah</span>
<span class="nf">jz</span><span class="w"> </span><span class="no">short</span><span class="w"> </span><span class="no">loc_40137c</span>
</code></pre></div>

<p>This seems easy enough. </p>
<p>Initially I entered <code>149A</code> as the password but this turned out to be incorrect. The reason for this is because <code>scanf</code> was passed a format of <em>"%d"</em>.</p>
<div class="codehilite"><pre><span></span><code><span class="nf">mov</span><span class="w"> </span><span class="p">[</span><span class="no">esp</span><span class="err">+</span><span class="mi">18</span><span class="no">h</span><span class="err">+</span><span class="no">Format</span><span class="p">],</span><span class="w"> </span><span class="no">offset</span><span class="w"> </span><span class="no">aD</span><span class="w"> </span><span class="c1">; &quot;%d&quot;</span>
<span class="nf">call</span><span class="w"> </span><span class="no">_scanf</span>
</code></pre></div>

<p>This means that the input it expects is actually a decimal integer. So converting <code>149A</code> to decimal results in <code>5274 …</code></p>
            </div>
            <div class="tags">
                <a href="../tag/re.html" class="tag">re</a>
                <a href="../tag/crackme.html" class="tag">crackme</a>
            </div>
        </div>
        <div class="post-item">
            <h2 class="post-title">
                <a href="../ioli-crackme-0x00.html">IOLI Crackme 0x00</a>
            </h2>
            <div class="article-meta">
                <time datetime="2021-02-16T21:55:00+08:00">Tue 16 February 2021</time>
            </div>
            <div class="post-summary">
                <p>I am re-familiarizing myself with reverse engineering again by going through some simple crackme challenges. This one is called the IOLI Crackmes by pof. The goal is to find the correct password and also to patch it so that it can accept any input and still show that it's correct.</p>
<h2 id="getting-the-password">Getting the password</h2>
<p>Running the program shows a password prompt. </p>
<p><img alt="ioli-crackme-0x00-03" src="../images/ioli-crackme-0x00-03.png" /></p>
<p>Of course, randomly entering passwords is going to be a waste of time so I opened up IDA to look at its code.</p>
<p>I knew that whatever password I enter in the program would be checked against the actual password. This is the part of the program that I should focus on so I scanned the code and found this:</p>
<p><img alt="ioli-crackme-0x00-02" src="../images/ioli-crackme-0x00-02.png" /></p>
<div class="codehilite"><pre><span></span><code><span class="nf">mov</span><span class="w"> </span><span class="p">[</span><span class="no">esp</span><span class="err">+</span><span class="mi">38</span><span class="no">h</span><span class="err">+</span><span class="no">Str2</span><span class="p">],</span><span class="w"> </span><span class="no">offset</span><span class="w"> </span><span class="no">Str2</span><span class="c1">; &quot;250382&quot;</span>
<span class="nf">mov</span><span class="w"> </span><span class="p">[</span><span class="no">esp</span><span class="err">+</span><span class="mi">38</span><span class="no">h</span><span class="err">+</span><span class="no">Format</span><span class="p">],</span><span class="w"> </span><span class="no">eax</span><span class="c1">; </span>
<span class="nf">call</span><span class="w"> </span><span class="no">_strcmp</span>
</code></pre></div>

<p>And just from these few lines alone I already knew what the password is …</p>
            </div>
            <div class="tags">
                <a href="../tag/re.html" class="tag">re</a>
                <a href="../tag/crackme.html" class="tag">crackme</a>
            </div>
        </div>
    </div>
</article>
        </div>
    </main>

    <script src="../theme/js/main.js"></script>
    
    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-55068085-2"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'UA-55068085-2');
    </script>
</body>
</html>