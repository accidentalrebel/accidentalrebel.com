Title: Adding Automation to Blue-Jupyter Malware Notebook
Date: 2023-01-23 21:02
Slug: adding-automation-to-blue-jupyter-malware-notebook
Tags: malware, re, jupyter
Category: Malware Analysis
Image: adding-automation-to-blue-jupyter-malware-notebook-02.png
Summary: Automating malware sample discovery with a Jupyter notebook that downloads from Malware Bazaar and runs Capa capability analysis on each sample automatically.

I came across the [Blue-Jupyter project on Github](https://github.com/mttaggart/blue-jupyter) while researching Jupyter notebooks. This [short demo video](https://www.youtube.com/watch?v=-EX5Ybbt8uE) got me excited, so I cloned the project and added some improvements that automate many things when I am looking for malware to investigate.

# What are Jupyter Notebooks?
For readers who may be unfamiliar, Jupyter Notebooks are a web-based tool that allows users to create and share documents that contain live code, equations, visualizations, and narrative text. They are a popular tool among data scientists and researchers but have also adapted for use in other fields, such as cybersecurity.

# My Additions to the Blue-Jupyter 
Many of the changes I've made are focused on automating the process of quickly looking for interesting new samples to investigate.

One addition to the notebook is the automated downloading of samples from [Malware Bazaar](https://bazaar.abuse.ch/). This can download a maximum of 100 samples continuously. Additional information is listed to highlight some interesting points about the sample, like the malware signature. It also can skip samples that have already been downloaded to save bandwidth.

![adding-automation-to-blue-jupyter-malware-notebook-01]({attach}/images/adding-automation-to-blue-jupyter-malware-notebook-01.png)

The second significant addition is the automated generation of [Capa](https://github.com/mandiant/capa) results for each downloaded sample. This makes it easy to see which malware has a particular capability so I can quickly see which ones are interesting enough to investigate further.

![adding-automation-to-blue-jupyter-malware-notebook-02]({attach}/images/adding-automation-to-blue-jupyter-malware-notebook-02.png)

I also added minor improvements like error handling, additional logging for troubleshooting, and some cleanup code just in case I want to start fresh.

# Check it out
If you are interested in checking it out, you can view my fork of the repository [here](https://github.com/accidentalrebel/blue-jupyter/blob/main/malware-analysis/Malware-Analysis.ipynb). I did not request for a pull request on the original branch because I've changed a lot of things that the original owner might not prefer to have. Of course, I encourage everyone to fork what I made and make it their own. That's the beauty of Jupyter notebooks, anyway.

Capa's output maps to the [Malware Behavior Catalog (MBC)]({filename}/talking-about-mitres-malware-behavior-catalog.md), a MITRE framework that standardizes malware behavior descriptions.

For another automated approach to malware analysis, see how I used machine learning to [classify malware packers]({filename}/classifying-malware-packers-using-machine-learning.md).
