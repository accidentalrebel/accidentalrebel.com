Title: Malware sandbox evasion in x64 assembly by checking ram size - Part 2
Date: 2022-08-08 11:29
Status: Draft
Slug: malware-sandbox-evasion-in-x64-assembly-by-checking-ram-size-part-2
Tags: malware, sandbox, evasion, x64, assembly

## Using GlobalMemoryStatusEx

As mentioned before, `GlobalMemoryStatusEx` is an alternative function to use when getting the amount of RAM in a machine. It gets the information differently from `GetPhysicallyInstalledSystemMemory` and there is also no guarantee that two sequential calls to the function will return the same information.

Here is the C code for this:

```c
#include <stdio.h>
#include <windows.h>

int main(void)
{
	MEMORYSTATUSEX statex;
  	statex.dwLength = sizeof (statex);
  	GlobalMemoryStatusEx (&statex);
  	printf ("Memory size: %*I64d", 7, statex.ullTotalPhys/1024);
}
```
