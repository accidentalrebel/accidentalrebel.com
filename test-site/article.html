<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Adding Automation to Blue-Jupyter Malware Notebook | AccidentalRebel</title>
    
    <link rel="stylesheet" href="theme/css/main.css">
</head>
<body>
    <div class="progress-bar" id="progress"></div>
    
    <header>
        <div class="container">
            <nav>
                <a href="/" class="site-title">AccidentalRebel</a>
                <button class="menu-toggle" onclick="toggleMenu()">☰</button>
                <ul class="nav-links" id="navLinks">
                    <li><a href="/archives.html">Archives</a></li>
                    <li><a href="/categories.html">Categories</a></li>
                    <li><a href="/tags.html">Tags</a></li>
                    <li><a href="/about.html">About</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <!-- Comic strip divider -->
    <div class="comic-container">
        <div class="comic-strip"></div>
    </div>

    <main>
        <div class="container">
            <article>
                <header class="article-header">
                    <h1>Adding Automation to Blue-Jupyter Malware Notebook</h1>
                    <div class="article-meta">
                        <time>January 23, 2023</time>
                        <span>•</span>
                        <span>5 min read</span>
                        <span>•</span>
                        <a href="/category/malware.html">malware</a>
                    </div>
                </header>

                <div class="article-content">
                    <p>I came across the <a href="https://github.com/mttaggart/blue-jupyter">Blue-Jupyter project on Github</a> while researching Jupyter notebooks. This short demo video got me excited, so I cloned the project and added some improvements that automate many things when I am looking for malware to investigate.</p>

                    <h2>What are Jupyter Notebooks?</h2>
                    <p>For readers who may be unfamiliar, Jupyter Notebooks are a web-based tool that allows users to create and share documents that contain live code, equations, visualizations, and narrative text. They are a popular tool among data scientists and researchers but have also adapted for use in other fields, such as cybersecurity.</p>

                    <h2>My Additions to the Blue-Jupyter</h2>
                    <p>Many of the changes I've made are focused on automating the process of quickly looking for interesting new samples to investigate.</p>

                    <p>One addition to the notebook is the automated downloading of samples from <strong>Malware Bazaar</strong>. This can download a maximum of 100 samples continuously. Additional information is listed to highlight some interesting points about the sample, like the malware signature.</p>

                    <pre><code class="python"># Example Python code block
def download_samples(limit=100):
    """Download malware samples from Malware Bazaar"""
    samples = []
    url = "https://bazaar.abuse.ch/api/v1/"
    
    for i in range(limit):
        response = requests.get(url + "recent_samples")
        if response.status_code == 200:
            data = response.json()
            samples.extend(data['samples'])
            
    return samples

# Usage example
malware_samples = download_samples(50)
print(f"Downloaded {len(malware_samples)} samples")</code></pre>

                    <p>The second significant addition is the automated generation of <strong>Capa</strong> results for each downloaded sample. This makes it easy to see which malware has a particular capability so I can quickly see which ones are interesting enough to investigate further.</p>

                    <h2>JavaScript Example</h2>
                    <p>Here's how you might implement similar functionality in JavaScript:</p>

                    <pre><code class="javascript">// JavaScript implementation
async function analyzeMalware(samples) {
    const results = [];
    
    for (const sample of samples) {
        try {
            const analysis = await performStaticAnalysis(sample);
            results.push({
                hash: sample.hash,
                capabilities: analysis.capabilities,
                score: calculateThreatScore(analysis)
            });
        } catch (error) {
            console.error(`Analysis failed for ${sample.hash}:`, error);
        }
    }
    
    return results.sort((a, b) => b.score - a.score);
}</code></pre>

                    <h2>Shell Commands</h2>
                    <p>You can also automate the process using shell scripts:</p>

                    <pre><code class="bash">#!/bin/bash
# Download and analyze malware samples

SAMPLE_DIR="/tmp/malware_samples"
mkdir -p "$SAMPLE_DIR"

# Download recent samples
curl -X GET "https://bazaar.abuse.ch/api/v1/recent_samples" \
    -H "accept: application/json" \
    -o "$SAMPLE_DIR/recent.json"

# Extract and analyze each sample
cat "$SAMPLE_DIR/recent.json" | jq -r '.samples[].hash' | while read hash; do
    echo "Analyzing $hash..."
    capa "$SAMPLE_DIR/$hash.bin" > "$SAMPLE_DIR/$hash.capa"
done</code></pre>

                    <h2>Check it out</h2>
                    <p>If you are interested in checking it out, you can view my fork of the repository <a href="https://github.com/accidentalrebel/blue-jupyter">here</a>. I did not request for a pull request on the original branch because I've changed a lot of things that the original owner might not prefer to have.</p>

                    <blockquote>
                        <p><strong>Note:</strong> Always be careful when working with malware samples. Use isolated environments and follow proper safety protocols.</p>
                    </blockquote>
                </div>

                <footer class="article-footer">
                    <div class="tags">
                        <a href="/tag/malware.html" class="tag">malware</a>
                        <a href="/tag/re.html" class="tag">re</a>
                        <a href="/tag/jupyter.html" class="tag">jupyter</a>
                        <a href="/tag/python.html" class="tag">python</a>
                        <a href="/tag/automation.html" class="tag">automation</a>
                    </div>
                </footer>
            </article>
        </div>
    </main>

    <script src="theme/js/main.js"></script>
</body>
</html>