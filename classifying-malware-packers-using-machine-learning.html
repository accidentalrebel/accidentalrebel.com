<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Classifying Malware Packers Using Machine Learning | AccidentalRebel.com</title>
    
    <link href="https://www.accidentalrebel.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="AccidentalRebel.com Atom Feed" />
    
    <link rel="stylesheet" href="./theme/css/main.css">
    
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="article">
    <meta property="og:url" content="./classifying-malware-packers-using-machine-learning.html">
    <meta property="og:title" content="Classifying Malware Packers Using Machine Learning">
    <meta property="og:description" content="The recent rise in popularity of AI reignited my interest in machine learning. It inspired me to dive deeper into understanding how it can be applied to malware analysis and, more importantly, how to better detect malware packers, as almost every malware nowadays uses them. My research and experiments eventually led me to make a web app, which I call the VGL4NT Malware Packer Classifier (https://packers.vgl4nt.com/).). (For those curious, V.G.L.4.N.T. is a play on "Vigilant" and stands for "Visual Guided Learning 4 Neutralizing Threats") Current State of Packer Detection Traditional packer detection approaches like DiE (Detect it Easy) and Yara rules depend on known signatures and patterns to identify packers. These tools scrutinize a file for specific indicators, like unique sequences of bytes or strings. While effective in many cases, they have drawbacks, like when a packer is modified or if the …">

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="./classifying-malware-packers-using-machine-learning.html">
    <meta property="twitter:title" content="Classifying Malware Packers Using Machine Learning">
    <meta property="twitter:description" content="The recent rise in popularity of AI reignited my interest in machine learning. It inspired me to dive deeper into understanding how it can be applied to malware analysis and, more importantly, how to better detect malware packers, as almost every malware nowadays uses them. My research and experiments eventually led me to make a web app, which I call the VGL4NT Malware Packer Classifier (https://packers.vgl4nt.com/).). (For those curious, V.G.L.4.N.T. is a play on "Vigilant" and stands for "Visual Guided Learning 4 Neutralizing Threats") Current State of Packer Detection Traditional packer detection approaches like DiE (Detect it Easy) and Yara rules depend on known signatures and patterns to identify packers. These tools scrutinize a file for specific indicators, like unique sequences of bytes or strings. While effective in many cases, they have drawbacks, like when a packer is modified or if the …">
</head>
<body>
    <div class="progress-bar" id="progress"></div>
    
    <header>
        <div class="container">
            <nav>
                <a href="./" class="site-title">AccidentalRebel.com</a>
                <button class="menu-toggle" onclick="toggleMenu()">☰</button>
                <ul class="nav-links" id="navLinks">
                    <li><a href="./archives.html">Archives</a></li>
                    <li><a href="./categories.html">Categories</a></li>
                    <li><a href="./tags.html">Tags</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <!-- Comic strip divider -->
    <div class="comic-container">
        <div class="comic-strip"></div>
    </div>

    <main>
        <div class="container">
<article>
    <header class="article-header">
        <h1>Classifying Malware Packers Using Machine Learning</h1>
        <div class="article-meta">
            <time datetime="2023-04-22T08:44:00+08:00">Sat 22 April 2023</time>
            <span>•</span>
            <a href="./category/misc.html">misc</a>
        </div>
    </header>

    <div class="article-content">
        <p>The recent rise in popularity of AI reignited my interest in machine learning. It inspired me to dive deeper into understanding how it can be applied to malware analysis and, more importantly, how to better detect malware packers, as almost every malware nowadays uses them.</p>
<p>My research and experiments eventually led me to make a web app, which I call the VGL4NT Malware Packer Classifier (<a href="https://packers.vgl4nt.com/).">https://packers.vgl4nt.com/).</a>).</p>
<p><img alt="classifying-malware-packers-using-machine-learning-01" src="./images/classifying-malware-packers-using-machine-learning-01.png" /></p>
<p>(For those curious, V.G.L.4.N.T. is a play on "Vigilant" and stands for "Visual Guided Learning 4 Neutralizing Threats")</p>
<h1 id="current-state-of-packer-detection">Current State of Packer Detection</h1>
<p>Traditional packer detection approaches like DiE (Detect it Easy) and Yara rules depend on known signatures and patterns to identify packers. These tools scrutinize a file for specific indicators, like unique sequences of bytes or strings. While effective in many cases, they have drawbacks, like when a packer is modified or if the sequence of bytes or strings are altered.</p>
<p>By using machine learning, the VGL4NT Malware Packer Classifier can be able to take into account minute differences and still be able to detect the packer used.</p>
<h1 id="how-it-works">How it works</h1>
<ul>
<li>The uploaded executable file's bytes are converted into grayscale values, creating an image..</li>
<li>The grayscale image is then fed into an image machine-learning model I trained from scratch.</li>
<li>It returns a list of percentages on how similar it is to other Packers.</li>
</ul>
<p><img alt="classifying-malware-packers-using-machine-learning-01" src="./images/classifying-malware-packers-using-machine-learning-02.png" /></p>
<p>The approach above is nothing new and is based on <a href="https://ieeexplore.ieee.org/abstract/document/8328749">this academic paper</a>. The difference is that the paper has a tool that classifies malware families, while mine classifies the packers used.</p>
<p>Most of the magic happens in the model itself. I've trained it on several packed malware samples and measured its accuracy using multiple iterations. The latest version of this model has a 94% accuracy, which is calculated by comparing the model's predictions to the actual packer labels in a dataset that the model hasn't seen before (the test dataset).</p>
<h1 id="current-limitations">Current limitations</h1>
<p>The app works for the most part, but it has its limitations. For example, users can only upload executable files (EXE, Bin, ELF, DLLs, etc) with a maximum size limit of 10MB. </p>
<p>Furthermore, due to costs of GPU resources during training, only the following packer tools can be classified:</p>
<ul>
<li>aspack</li>
<li>alienyze</li>
<li>amber</li>
<li>mew</li>
<li>mpress</li>
<li>nspack</li>
<li>pecompact</li>
<li>petite</li>
<li>themida</li>
<li>upx</li>
<li>others (Everything else)</li>
</ul>
<p>The list of packer tools above was chosen based on available real-world malware samples that I have encountered or studied.</p>
<h1 id="future-plans-and-updates">Future Plans and Updates</h1>
<p>If this project gains enough interest, then I plan to add more improvements, such as:</p>
<ul>
<li>Increase GPU resources to increase the model's capacity to classify more categories</li>
<li>Improvements in the training method by handpicking the most important parts of the executable and then feeding that to the model</li>
<li>Offer an API for integration with existing tools and processes.</li>
</ul>
<p>Of course, this project would improve a lot with the community's help. I encourage users to provide feedback, report issues, or request new features. Feel free to throw your thoughts to me through my email, karlo@accidentalrebel.com, or Twitter at @accidentalrebel.</p>
    </div>

    <footer class="article-footer">
        <div class="tags">
            <a href="./tag/artificial_intelligence.html" class="tag">artificial_intelligence</a>
            <a href="./tag/machine_learning.html" class="tag">machine_learning</a>
        </div>
    </footer>
</article>


<section class="comments">
    <div id="disqus_thread"></div>
    <script>
        var disqus_config = function () {
            this.page.url = "./classifying-malware-packers-using-machine-learning.html";
            this.page.identifier = "classifying-malware-packers-using-machine-learning";
        };
        (function() {
            var d = document, s = d.createElement('script');
            s.src = 'https://AccidentalRebel.disqus.com/embed.js';
            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</section>
        </div>
    </main>

    <script src="./theme/js/main.js"></script>
    
    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-55068085-2"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'UA-55068085-2');
    </script>
</body>
</html>