<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>malware | AccidentalRebel.com</title>
    
    <link href="https://www.accidentalrebel.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="AccidentalRebel.com Atom Feed" />
    
    <link rel="stylesheet" href="../theme/css/main.css">
    
</head>
<body>
    <div class="progress-bar" id="progress"></div>
    
    <header>
        <div class="container">
            <nav>
                <a href="../" class="site-title">AccidentalRebel.com</a>
                <button class="menu-toggle" onclick="toggleMenu()">☰</button>
                <ul class="nav-links" id="navLinks">
                    <li><a href="../archives.html">Archives</a></li>
                    <li><a href="../categories.html">Categories</a></li>
                    <li><a href="../tags.html">Tags</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <!-- Comic strip divider -->
    <div class="comic-container">
        <div class="comic-strip"></div>
    </div>

    <main>
        <div class="container">
<article>
    <header class="article-header">
        <h1>Tag: malware</h1>
    </header>

    <div class="article-content">
        <div class="post-item">
            <h2 class="post-title">
                <a href="../adding-automation-to-blue-jupyter-malware-notebook.html">Adding Automation to Blue-Jupyter Malware Notebook</a>
            </h2>
            <div class="article-meta">
                <time datetime="2023-01-23T21:02:00+08:00">Mon 23 January 2023</time>
                <span>•</span>
                <a href="../category/malware.html">malware</a>
            </div>
            <div class="post-summary">
                <p>I came across the <a href="https://github.com/mttaggart/blue-jupyter">Blue-Jupyter project on Github</a> while researching Jupyter notebooks. This <a href="https://www.youtube.com/watch?v=-EX5Ybbt8uE">short demo video</a> got me excited, so I cloned the project and added some improvements that automate many things when I am looking for malware to investigate.</p>
<h1 id="what-are-jupyter-notebooks">What are Jupyter Notebooks?</h1>
<p>For readers who may be unfamiliar, Jupyter Notebooks are a web-based tool that allows users to create and share documents that contain live code, equations, visualizations, and narrative text. They are a popular tool among data scientists and researchers but have also adapted for use in other fields, such as cybersecurity.</p>
<h1 id="my-additions-to-the-blue-jupyter">My Additions to the Blue-Jupyter</h1>
<p>Many of the changes I've made are focused on automating the process of quickly looking for interesting new samples to investigate.</p>
<p>One addition to the notebook is the automated downloading of samples from <a href="https://bazaar.abuse.ch/">Malware Bazaar</a>. This can download a maximum of 100 samples continuously. Additional information is listed to highlight …</p>
            </div>
        </div>
        <div class="post-item">
            <h2 class="post-title">
                <a href="../malware-sandbox-evasion-in-x64-assembly-by-checking-ram-size-part-2.html">Malware sandbox evasion in x64 assembly by checking ram size - Part 2</a>
            </h2>
            <div class="article-meta">
                <time datetime="2022-08-15T11:29:00+08:00">Mon 15 August 2022</time>
                <span>•</span>
                <a href="../category/misc.html">misc</a>
            </div>
            <div class="post-summary">
                <p>In the <a href="../malware-sandbox-evasion-in-x64-assembly-by-checking-ram-size-part-2.html">previous post</a>, I explored a sandbox evasion technique that uses <code>GetPhysicallyInstalledSystemMemory</code> to check the size of the RAM of the machine. The idea behind this technique (MBC Technique ID: <a href="https://github.com/MBCProject/mbc-markdown/blob/master/anti-behavioral-analysis/virtual-machine-detection.md">B0009.014</a>) is that any value that is lower than 4GB <em>may</em> probably be a sandbox (to reduce costs). This information can then be used with other sandbox evasion techniques to confirm.</p>
<p>For part 2 of this series, I'll be talking about an alternative Windows API function called <code>GlobalMemoryStatusEx</code>. This function is as straightforward as the first one, but requires the passing of a pointer to a C struct. This is significant because I'll be converting a working C code to x64 assembly so we can fully understand how it works under the hood.</p>
<h2 id="using-globalmemorystatusex">Using GlobalMemoryStatusEx</h2>
<p>Here is an example of an implementation of <code>GlobalMemoryStatusEx</code> in C that we'll later be converting to x64 assembly.</p>
<div class="codehilite"><pre><span></span><code><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdio.h&gt;</span>
<span class="cp">#include …</span></code></pre></div>
            </div>
        </div>
        <div class="post-item">
            <h2 class="post-title">
                <a href="../malware-sandbox-evasion-in-x64-assembly-by-checking-ram-size-part-1.html">Malware sandbox evasion in x64 assembly by checking ram size - Part 1</a>
            </h2>
            <div class="article-meta">
                <time datetime="2022-08-08T11:29:00+08:00">Mon 08 August 2022</time>
                <span>•</span>
                <a href="../category/misc.html">misc</a>
            </div>
            <div class="post-summary">
                <p>During my malware sandbox evasion research, I stumbled upon the <a href="https://unprotect.it/">Unprotect Project</a> website. It is a community-contributed repository of evasion techniques used by malware. I saw that the the <a href="https://unprotect.it/technique/checking-memory-size/">Checking Memory Size technique</a> doesn't have a example snippet yet so I figured this would be a good first contribution to the project.</p>
<p><img alt="malware-sandbox-evasion-in-x64-assembly-by-checking-ram-size-part-1-03" src="../images/malware-sandbox-evasion-in-x64-assembly-by-checking-ram-size-part-1-03.png" /></p>
<h2 id="what-to-expect">What to expect</h2>
<p>In this blog post I'll be making a code snippet that showcases how to get the size of a computer's RAM in C. I will then convert this code into x64 assembly, mostly for me to practice writing in it, but also so that we can understand it better.</p>
<h2 id="checking-the-memory">Checking the memory</h2>
<p>The idea behind this evasion technique is simple. Most modern user machines will have at least around 4GB of RAM. Anything lower than that can be an indication that the machine is probably a sandbox (To save costs). While it's not exactly fool-proof …</p>
            </div>
        </div>
        <div class="post-item">
            <h2 class="post-title">
                <a href="../talking-about-mitres-malware-behavior-catalog.html">Talking about Mitre's Malware Behavior Catalog</a>
            </h2>
            <div class="article-meta">
                <time datetime="2022-08-02T15:06:00+08:00">Tue 02 August 2022</time>
                <span>•</span>
                <a href="../category/malware.html">malware</a>
            </div>
            <div class="post-summary">
                <p>I gave a 10-minute lightning talk at the recently concluded Blackhat Middle East &amp; Africa community meetup. The topic is about Mitre's Malware Behavior Catalog (MBC) framework and the existing tools for it. My reason for selecting this topic is because I feel that more people should know about Mitre's not-so-well-known project.</p>
<p><img alt="talking-about-mitres-malware-behavior-catalog-01" src="../images/talking-about-mitres-malware-behavior-catalog-01.png" /></p>
<h2 id="a-brief-overview">A brief overview</h2>
<p>MBC is a framework made by Mitre, similar to ATT&amp;CK, but focuses on malware. It lists down the common objectives and behaviors commonly seen in malware. The purpose is to have standardize reporting so that everyone would use the same definitions when writing and talking about malware. This also aids with analysis and correlation with other tools.</p>
<p>It has it's own matrix with malware objectives as headers for columns and an entry for each behavior. Each behavior then has a list of methods that explains how that behavior is achieved, example of malware that uses …</p>
            </div>
        </div>
        <div class="post-item">
            <h2 class="post-title">
                <a href="../converting-a-malware-dropper-to-x64-assembly.html">Converting a malware dropper to x64 assembly</a>
            </h2>
            <div class="article-meta">
                <time datetime="2022-07-03T09:18:00+08:00">Sun 03 July 2022</time>
                <span>•</span>
                <a href="../category/misc.html">misc</a>
            </div>
            <div class="post-summary">
                <p>In this post I'll be listing down lessons I learned while converting a simple malware dropper written in C to x64 assembly. </p>
<p>I started this project as a way to deepen my understanding of assembly so I could be better in malware development and reverse engineering (And also because I love coding in assembly and would always find an excuse to use it).</p>
<h2 id="what-to-expect">What to expect</h2>
<p>I'll be going through sections of the C file and show the how it can be written accordingly in x64 Windows assembly. Take note, however, that the conversion is not one-to-one, meaning there are other ways of writing it. What I did was to structure the assembly code so that you can easily compare it with the C code while making sure that the end result will be the same.</p>
<p>I won't be covering the basics of assembly because <a href="https://sonictk.github.io/asm_tutorial/">this post</a> does a better …</p>
            </div>
        </div>
        <div class="post-item">
            <h2 class="post-title">
                <a href="../building-my-virtual-cybersecurity-home-lab.html">Building my Virtual Cybersecurity Home Lab</a>
            </h2>
            <div class="article-meta">
                <time datetime="2021-09-05T20:33:00+08:00">Sun 05 September 2021</time>
                <span>•</span>
                <a href="../category/malware.html">malware</a>
            </div>
            <div class="post-summary">
                <p>I have recently realized that one part of cybersecurity that I am lacking basic knowledge on is networking. I honestly did not think it was important when I was starting. It was the reason why I skipped Network+ so I could take Security+ directly. </p>
<p>Now I know better.</p>
<p>Ever since my realization, I have taken steps to patch the holes in my knowledge. I've started taking courses and bought books. But one thing that has made the most impact is me building my very own "homelab".</p>
<p>I first came to know of the concept of homelabs <a href="https://www.reddit.com/r/homelab/">from Reddit</a>. To those unfamiliar, it is the practice of building a networked environment to gain practical knowledge in networking and IT. One way to do this is by making a virtual network.</p>
<p>And so, over the past month, I have been building my very own virtual homelab with a focus on integrating cybersecurity …</p>
            </div>
        </div>
        <div class="post-item">
            <h2 class="post-title">
                <a href="../making-a-rat.html">Making a RAT</a>
            </h2>
            <div class="article-meta">
                <time datetime="2021-07-13T14:56:00+08:00">Tue 13 July 2021</time>
                <span>•</span>
                <a href="../category/malware.html">malware</a>
            </div>
            <div class="post-summary">
                <p>A Remote Access Tool (RAT) is used to remotely access a computer. It has legitimate uses but it can also be used for malicious purposes. I've seen it used in malware I've analyzed and I've always been curious as to how it works.</p>
<p>I was following along the <a href="https://handmadehero.org/">Handmade Hero project</a> <sup id="fnref:1"><a class="footnote-ref" href="#fn:1">1</a></sup> when the topic about dynamic DLL loading came up. This is a process of dynamically loading a DLL at runtime which is useful if you want your program to check if a DLL is present in a system before loading it.</p>
<p>Two of the system calls that were discussed were LoadLibrary and GetProcAddress. These were familiar to me as I've seen them used on malware shellcode I analyzed in the past. I later learned that this is also used as an anti-virus evasion technique. I found this interesting.</p>
<p>Having learned how to do runtime DLL loading myself I …</p>
            </div>
        </div>
        <div class="post-item">
            <h2 class="post-title">
                <a href="../maldoc101-writeup-part-2.html">Maldoc101 Writeup (Part 2)</a>
            </h2>
            <div class="article-meta">
                <time datetime="2021-03-14T08:34:00+08:00">Sun 14 March 2021</time>
                <span>•</span>
                <a href="../category/malware_analysis.html">malware_analysis</a>
            </div>
            <div class="post-summary">
                <p>This is part 2 of my writeup for the Maldoc101 challenge. Check out <a href="../maldoc101-writeup-part-1.html">part 1</a> for the beginning of the analysis.</p>
<p>The next couple of lines does the same concatenating technique similar to the previous steps. </p>
<div class="codehilite"><pre><span></span><code>deaknaugthein = roubhaol.kaizseah.ControlTipText
giakfeiw = deulsaocthuul + gooykadheoj + roubhaol.paerwagyouqumeid.ControlTipText + deaknaugthein
queegthaen = giakfeiw + roubhaol.joefwoefcheaw
</code></pre></div>

<p>At the end of the code above <code>queegthaen</code> now contains the value <code>Win32_Process</code> + <code>s</code> + <code>tar</code> + <code>tu</code> + <code>P</code>. Or when combined creates the string <code>Win32_ProcessstartuP</code> which probably refers <a href="https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-processstartup">to this WMI class</a> in the Microsoft docs.</p>
<p><em>Note: This writeup appears to be incomplete. For the complete analysis, please refer to <a href="../maldoc101-writeup-part-1.html">part 1</a> of this series.</em></p>
            </div>
        </div>
        <div class="post-item">
            <h2 class="post-title">
                <a href="../maldoc101-writeup-part-1.html">Maldoc101 Writeup (Part 1)</a>
            </h2>
            <div class="article-meta">
                <time datetime="2021-03-13T08:34:00+08:00">Sat 13 March 2021</time>
                <span>•</span>
                <a href="../category/malware_analysis.html">malware_analysis</a>
            </div>
            <div class="post-summary">
                <p>This is part 1 out of 2 of my writeup for the Maldoc101 challenge made by Josh Stroschein (<a href="https://twitter.com/jstrosch">@jstrosch</a>) and is currently playable at <a href="https://cyberdefenders.org/labs/51">Cyberdefenders.Org</a>. I've done some maldoc analysis before but this is the first time I'm writing about my approach.</p>
<p>There is also an already existing writeup about this challenge <a href="https://github.com/jstrosch/malware-samples/blob/master/malware_analysis_exercises/2020/December/solution.md">from the creator himself</a>. You should check that out if you want a more detailed and focused writeup. This writeup is more from the perspective of someone relatively new to malware analysis. There's a lot more exploration and trial-and-error which, I hope, might give the reader a different view in how this kind of problem is approached.</p>
<h2 id="the-challenge">The challenge</h2>
<h3 id="name">Name</h3>
<p><a href="https://cyberdefenders.org/labs/51">MalDoc101 - Malicious Document</a></p>
<h3 id="description">Description</h3>
<p>It is common for threat actors to utilize living off the land (LOTL) techniques, such as the execution of PowerShell to further their attacks and transition from macro code. This challenge is intended …</p>
            </div>
        </div>
    </div>
</article>
        </div>
    </main>

    <script src="../theme/js/main.js"></script>
    
    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-55068085-2"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'UA-55068085-2');
    </script>
</body>
</html>