<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>AccidentalRebel.com - Articles by AccidentalRebel</title>
  <meta name="author" content="AccidentalRebel">

  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link rel="canonical" href="..">

  <link href="../favicon.png" rel="icon">

  <link href="https://www.accidentalrebel.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="AccidentalRebel.com Full Atom Feed" />

  <link href="../theme/css/screen.css"  media="screen, projection" rel="stylesheet" type="text/css" />
  <link href="../theme/css/tomorrow.css"  media="screen, projection" rel="stylesheet" type="text/css" />

  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.8.3/modernizr.js"></script>
  <script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>


</head>
  <body>

    <div class="container" id="site-title">
      <div class="col-md-8 col-md-offset-2">
	<h1>
	  <a href="..">
	    AccidentalRebel.com
	  </a>
	</h1>
	<div id="profile">
	  <div class="left">
	    <img src="../theme/images/pic.png" />
	  </div>
	  <div class="right">
	    Karlo is a programmer for 10+ years who switched to cyber security. He is currently working as a L2 SOC Analyst and is focusing on malware reverse engineering and development.
	  </div>
	  <div class="clear"></div>
	</div>
	<div id="nav">
	  <ul>
	    <li><a href="..">Home</a></li>
	    <!-- <li><a href="../pages/made.html">My Works</a></li> -->
	    <li class="icon-nav" id="twitter-nav"><a href="https://twitter.com/accidentalrebel">Twitter</a></li>
	    <li class="icon-nav" id="github-nav"><a href="https://github.com/accidentalrebel">Github</a></li>
	    <li class="icon-nav" id="feed-nav"><a href="./feeds/all.atom.xml">RSS</a></li>
	  </ul>
	</div>
      </div>
    </div>

<div class="container">
  <!-- CONTENT GOES HERE -->
  <div class="row">
    <div class="col-md-8 col-md-offset-2">
      <article>
        <h1><a href="../building-my-virtual-cybersecurity-home-lab.html">Building my Virtual Cybersecurity Home Lab</a></h1>
	<div class="meta">
          <time datetime="2021-09-05T20:33:00+08:00">September 05, 2021</time>
          in <span class="categories">
            <a href="../tag/malware.html">malware</a>,            <a href="../tag/dev.html">dev</a>          </span>
	</div>
        <p><p>I have recently realized that one part of cybersecurity that I am lacking basic knowledge on is networking. I honestly did not think it was important when I was starting. It was the reason why I skipped Network+ so I could take Security+ directly. </p>
<p>Now I know better.</p>
<p>Ever since my realization, I have taken steps to patch the holes in my knowledge. I've started taking courses and bought books. But one thing that has made the most impact is me building my very own "homelab".</p>
<p>I first came to know of the concept of homelabs <a href="https://www.reddit.com/r/homelab/">from Reddit</a>. To those unfamiliar, it is the practice of building a networked environment to gain practical knowledge in networking and IT. One way to do this is by making a virtual network.</p>
<p>And so, over the past month, I have been building my very own virtual homelab with a focus on integrating cybersecurity …</p>
          <!-- <a class="full-article-link pull-right" rel="full-article" href="../building-my-virtual-cybersecurity-home-lab.html">Read on →</a> -->
      </article>
    </div>
  </div>
  <!-- CONTENT GOES HERE -->
  <div class="row">
    <div class="col-md-8 col-md-offset-2">
      <article>
        <h1><a href="../making-a-rat.html">Making a RAT</a></h1>
	<div class="meta">
          <time datetime="2021-07-13T14:56:00+08:00">July 13, 2021</time>
          in <span class="categories">
            <a href="../tag/malware.html">malware</a>,            <a href="../tag/dev.html">dev</a>          </span>
	</div>
        <p><p>A Remote Access Tool (RAT) is used to remotely access a computer. It has legitimate uses but it can also be used for malicious purposes. I've seen it used in malware I've analyzed and I've always been curious as to how it works.</p>
<p>I was following along the <a href="https://handmadehero.org/">Handmade Hero project</a> <sup id="fnref:1"><a class="footnote-ref" href="#fn:1">1</a></sup> when the topic about dynamic DLL loading came up. This is a process of dynamically loading a DLL at runtime which is useful if you want your program to check if a DLL is present in a system before loading it.</p>
<p>Two of the system calls that were discussed were LoadLibrary and GetProcAddress. These were familiar to me as I've seen them used on malware shellcode I analyzed in the past. I later learned that this is also used as an anti-virus evasion technique. I found this interesting.</p>
<p>Having learned how to do runtime DLL loading myself I …</p>
          <!-- <a class="full-article-link pull-right" rel="full-article" href="../making-a-rat.html">Read on →</a> -->
      </article>
    </div>
  </div>
  <!-- CONTENT GOES HERE -->
  <div class="row">
    <div class="col-md-8 col-md-offset-2">
      <article>
        <h1><a href="../finding-phished-passwords-on-a-scam-site.html">Finding phished passwords on a scam site</a></h1>
	<div class="meta">
          <time datetime="2021-05-01T20:56:00+08:00">May 01, 2021</time>
          in <span class="categories">
            <a href="../tag/phishing.html">phishing</a>          </span>
	</div>
        <p><p>Since my last post about <a href="investigating-an-fb-phishing-site">my investigations of a Facebook phishing site</a>, I have received several messages from friends asking me to check out other suspected phishing/scam sites. One of the most alarming out of them was this one where I was able to find the file where the scammer stores the phished usernames and passwords.</p>
<p><img alt="finding-phished-passwords-from-a-scam-site-01" src="../images/finding-phished-passwords-from-a-scam-site-01.png" /></p>
<p>This particular phishing site conducts its operations like this:</p>
<ul>
<li>An ad is shown on Facebook, promising free coupons for famous fast food restaurants</li>
<li>Clicking on the ad takes the user to a fake Facebook login page hosted on <em>blogger.com</em></li>
<li>Login page then sends phished username and passwords to a PHP file hosted on <em>000webhost</em></li>
</ul>
<p>The phished passwords are then stored in a <code>.txt</code> file (blatantly named, <code>victims.txt</code>), which is publicly accessible on an open directory. Getting to this directory involved following the scripts and the URLs used by the scammers. It's …</p>
          <!-- <a class="full-article-link pull-right" rel="full-article" href="../finding-phished-passwords-on-a-scam-site.html">Read on →</a> -->
      </article>
    </div>
  </div>
  <!-- CONTENT GOES HERE -->
  <div class="row">
    <div class="col-md-8 col-md-offset-2">
      <article>
        <h1><a href="../emprisa-maldoc-writeup..html">Emprisa Maldoc Writeup</a></h1>
	<div class="meta">
          <time datetime="2021-04-30T05:58:00+08:00">April 30, 2021</time>
          in <span class="categories">
            <a href="../tag/writeup.html">writeup</a>          </span>
	</div>
        <p><blockquote>
<p>This is a writeup for <a href="the-emprisa-maldoc-challenge">Emprisa maldoc challenge</a> that I made for <a href="https://cyberdefenders.org/">CyberDefenders.org</a>. You can play it <a href="https://cyberdefenders.org/labs/56">here</a>.</p>
</blockquote>
<p>The very first thing that I do when confronted with a malicious document is to run it in a malware lab. This particular document, however, would not exhibit anything malicious on recent versions of Word.</p>
<p>A quick search of the hash on malware sandboxes would reveal that the document makes use of the <a href="https://nvd.nist.gov/vuln/detail/CVE-2017-18822">CVE-2017-18822 vulnerability</a>. This is a vulnerability that became known and was promptly patched around November of 2017.</p>
<p>The above details give us a hint on how to trigger the document, which is to run the maldoc on a version of Microsoft Word that doesn't have the patches that fix the vulnerability. The easiest way to do this is to boot up a new VM with a fresh install of Windows 7 and with updates disabled.</p>
<p>This new environment …</p>
          <!-- <a class="full-article-link pull-right" rel="full-article" href="../emprisa-maldoc-writeup..html">Read on →</a> -->
      </article>
    </div>
  </div>
  <!-- CONTENT GOES HERE -->
  <div class="row">
    <div class="col-md-8 col-md-offset-2">
      <article>
        <h1><a href="../investigating-an-fb-phishing-site.html">Investigating an FB phishing site</a></h1>
	<div class="meta">
          <time datetime="2021-04-24T05:58:00+08:00">April 24, 2021</time>
          in <span class="categories">
            <a href="../tag/phishing.html">phishing</a>          </span>
	</div>
        <p><p>Last April 21, people were posting warnings about a suspicious Facebook post where your account will supposedly get hacked when you click it. From the discussions, I gathered that it is a classic phishing site scam. A very effective one too, because as soon as an account gets compromised the attacker logs in and tags the friends in the account allowing it to spread further. The news of this got big that even the PH CERT issued <a href="https://www.facebook.com/Ncertgovph/posts/1879686332199270">a security advisory on it</a>.</p>
<p><img alt="checking-the-fb-phishing-site-02" src="../images/checking-the-fb-phishing-site-02.jpg" /></p>
<h1 id="i-was-just-curious-i-swear">I was just curious, I swear!</h1>
<p>I wanted to see the phishing site for myself but I was unlucky and did not get tagged by anyone. So I reached out to people who did and I eventually got to this page shown below:</p>
<p><img alt="checking-the-fb-phishing-site-01" src="../images/checking-the-fb-phishing-site-01.png" /></p>
<p>To a trained eye, one could easily see the obvious red flags. But how can one notice them if there is a very attention-catching image …</p>
          <!-- <a class="full-article-link pull-right" rel="full-article" href="../investigating-an-fb-phishing-site.html">Read on →</a> -->
      </article>
    </div>
  </div>
  <!-- CONTENT GOES HERE -->
  <div class="row">
    <div class="col-md-8 col-md-offset-2">
      <article>
        <h1><a href="../the-emprisa-maldoc-challenge.html">The Emprisa Maldoc Challenge</a></h1>
	<div class="meta">
          <time datetime="2021-04-04T16:37:00+08:00">April 04, 2021</time>
          in <span class="categories">
            <a href="../tag/maldoc.html">maldoc</a>,            <a href="../tag/ctf.html">ctf</a>          </span>
	</div>
        <p><p>I was inspired to make my own CTF challenge after finishing <a href="{filename}/maldoc101-writeup-part-1">Maldoc101</a> found at <a href="https://cyberdefenders.org/">Cyberdefenders.org</a>. The challenge I made is called <a href="https://cyberdefenders.org/labs/56">Emprisa Maldoc</a> and it is now up on their website. </p>
<p>Emprisa is based on a malicious document that I downloaded blindly from a malware sandbox. It used a relatively old but still interesting exploit that is still in use today. After researching more about it I came across a tool that can generate a malicious doc using the same exact exploit. This is when I got the idea to turn it into a challenge.</p>
<p><img alt="the-emprisa-maldoc-challenge-01" src="../images/the-emprisa-maldoc-challenge-01.png" /></p>
<p>The challenge has 14 questions with increasing and varying difficulty. The challenge is targeted towards intermediate analysts who already have experience examining maldocs before. The goal is to reinforce the use of common malware analysis tools, but at the same time, teach players new things and techniques. It involves flexing muscles related to open …</p>
          <!-- <a class="full-article-link pull-right" rel="full-article" href="../the-emprisa-maldoc-challenge.html">Read on →</a> -->
      </article>
    </div>
  </div>
  <!-- CONTENT GOES HERE -->
  <div class="row">
    <div class="col-md-8 col-md-offset-2">
      <article>
        <h1><a href="../ioli-crackme-0x03.html">IOLI Crackme 0x03</a></h1>
	<div class="meta">
          <time datetime="2021-03-22T20:03:00+08:00">March 22, 2021</time>
          in <span class="categories">
            <a href="../tag/re.html">re</a>,            <a href="../tag/crackme.html">crackme</a>          </span>
	</div>
        <p><p>I am continuing my reverse engineering review by tackling the <em>IOLI crackmes</em> by <a href="https://twitter.com/pof">@pof</a>. These are beginner friendly challenges that is perfect for newbies or for those who want to review the basics like me. Check out my writeups for <a href="../ioli-crackme-0x00.html">0x00</a>, <a href="../ioli-crackme-0x01.html">0x01</a>, and <a href="../ioli-crackme-0x02.html">0x02</a>.</p>
<h1 id="getting-the-password">Getting the password</h1>
<p>After opening the program in IDA I immediately saw that the code is almost exactly as the one in challenge <a href="../ioli-crackme-0x02.html">0x02</a>, with the exception of our expected <code>cmp</code> command being inside the <code>_test</code> function.</p>
<p><img alt="ioli-crackme-0x03-01" src="../images/ioli-crackme-0x03-01.png" /></p>
<p>Reading through the code I realized that the password for this challenge is exactly the same as the previous one!</p>
<p>But what's this? The success and failure messages are all garbled? And plus, what is this other new function called <code>_shift</code>?</p>
<p><img alt="ioli-crackme-0x03-02" src="../images/ioli-crackme-0x03-02.png" /></p>
<h1 id="a-different-kind-of-challenge">A different kind of challenge</h1>
<p>Opening up the <code>_shift</code> function shows us a short, but interesting looking program flow with two branches and one of the branches looping …</p>
          <!-- <a class="full-article-link pull-right" rel="full-article" href="../ioli-crackme-0x03.html">Read on →</a> -->
      </article>
    </div>
  </div>
  <!-- CONTENT GOES HERE -->
  <div class="row">
    <div class="col-md-8 col-md-offset-2">
      <article>
        <h1><a href="../maldoc101-writeup-part-1.html">Maldoc101 Writeup (Part 1)</a></h1>
	<div class="meta">
          <time datetime="2021-03-13T08:34:00+08:00">March 13, 2021</time>
          in <span class="categories">
            <a href="../tag/re.html">re</a>,            <a href="../tag/malware_analysis.html">malware_analysis</a>,            <a href="../tag/malware.html">malware</a>          </span>
	</div>
        <p><p>This is part 1 out of 2 of my writeup for the Maldoc101 challenge made by Josh Stroschein (<a href="https://twitter.com/jstrosch">@jstrosch</a>) and is currently playable at <a href="https://cyberdefenders.org/labs/51">Cyberdefenders.Org</a>. I've done some maldoc analysis before but this is the first time I'm writing about my approach.</p>
<p>There is also an already existing writeup about this challenge <a href="https://github.com/jstrosch/malware-samples/blob/master/malware_analysis_exercises/2020/December/solution.md">from the creator himself</a>. You should check that out if you want a more detailed and focused writeup. This writeup is more from the perspective of someone relatively new to malware analysis. There's a lot more exploration and trial-and-error which, I hope, might give the reader a different view in how this kind of problem is approached.</p>
<h2 id="the-challenge">The challenge</h2>
<h3 id="name">Name</h3>
<p><a href="https://cyberdefenders.org/labs/51">MalDoc101 - Malicious Document</a></p>
<h3 id="description">Description</h3>
<p>It is common for threat actors to utilize living off the land (LOTL) techniques, such as the execution of PowerShell to further their attacks and transition from macro code. This challenge is intended …</p>
          <!-- <a class="full-article-link pull-right" rel="full-article" href="../maldoc101-writeup-part-1.html">Read on →</a> -->
      </article>
    </div>
  </div>
  <!-- CONTENT GOES HERE -->
  <div class="row">
    <div class="col-md-8 col-md-offset-2">
      <article>
        <h1><a href="../ioli-crackme-0x02.html">IOLI Crackme 0x02</a></h1>
	<div class="meta">
          <time datetime="2021-03-06T10:34:00+08:00">March 06, 2021</time>
          in <span class="categories">
            <a href="../tag/re.html">re</a>,            <a href="../tag/crackme.html">crackme</a>          </span>
	</div>
        <p><p>I am continuing my reverse engineering review by tackling the <em>IOLI crackmes</em> by <a href="https://twitter.com/pof">@pof</a>. These are beginner friendly challenges that is perfect for newbies or for those who want to review the basics like me. Check out my writeups for <a href="../ioli-crackme-0x00.html">0x00</a> and <a href="../ioli-crackme-0x01.html">0x01</a>.</p>
<h1 id="getting-the-password">Getting the password</h1>
<p>After the first two challenges I kinda know what to expect already so I skipped running the program and immediately loaded it in IDA.</p>
<p><img alt="ioli-crackme-0x02-01" src="../images/ioli-crackme-0x02-01.png" /></p>
<p>So the lines leading to the comparison command now looks more complicated than before. We could easily see that there are some computations that happens thanks to the presence of <code>add</code> and <code>imul</code>. Before those, we have two values (<code>5Ah</code> and <code>1ECh</code>) which we can easily guess are the values that will be worked on by these arithmetic functions.</p>
<p>So going through the lines sequentially we can see that the two numbers are first added with <code>add [eax], edx</code>. Which …</p>
          <!-- <a class="full-article-link pull-right" rel="full-article" href="../ioli-crackme-0x02.html">Read on →</a> -->
      </article>
    </div>
  </div>
  <!-- CONTENT GOES HERE -->
  <div class="row">
    <div class="col-md-8 col-md-offset-2">
      <article>
        <h1><a href="../introducing-shcode2exe.html">Introducing shcode2exe</a></h1>
	<div class="meta">
          <time datetime="2021-02-26T07:34:00+08:00">February 26, 2021</time>
          in <span class="categories">
            <a href="../tag/re.html">re</a>,            <a href="../tag/tools.html">tools</a>,            <a href="../tag/malware_analysis.html">malware_analysis</a>          </span>
	</div>
        <p><p><strong>[Edit: shcode2exe is <a href="https://docs.remnux.org/discover-the-tools/dynamically+reverse-engineer+code/shellcode#shcode-2-exe">now part of Remnux</a>]</strong></p>
<p>I've been playing around with <a href="https://remnux.org/">Remnux</a> and encountered a problem trying to get one of the tools to run properly. The tool is <a href="https://github.com/repnz/shellcode2exe">shellcode2exe</a>, it is used to compile binary shellcode to a file so it can easily be debugged by a debugger.</p>
<p>When I checked out the code, I was surprised to find out how simple it is. Basically, what happens is that the inputted shellcode is added to a barebones assembly file using the <code>incbin</code> assembly instruction. From there, the file is then automatically compiled and linked.</p>
<p>One big problem with the tool is that it needs to use <a href="https://www.winehq.org/">Wine</a> if it needs to run on Linux. I don't want such a huge dependency especially for my own malware analysis lab so I decided to write my own version which have led to the creation of <code>shcode2exe</code>.</p>
<h2 id="shcode2exe">shcode2exe</h2>
<p>While similar in …</p>
          <!-- <a class="full-article-link pull-right" rel="full-article" href="../introducing-shcode2exe.html">Read on →</a> -->
      </article>
    </div>
  </div>
</div>
<div class="pagination">
<p class="paginator">
        <a href="../author/accidentalrebel.html">&#8647;</a>
        <a href="../author/accidentalrebel.html">&laquo;</a>
    Page 2 / 4
        <a href="../author/accidentalrebel3.html">&raquo;</a>
        <a href="../author/accidentalrebel4.html">&#8649;</a>
</p>
</div>
    <footer id="footer" class="her-row">
      <div class="container">
        <div class="row">
          <h4>Powered by <a href="http://blog.getpelican.com/">Pelican</a>. Designed by <a href="http://AdrianArtiles.com">Adrian Artiles</a>.</h4>
        </div>
      </div>
    </footer>

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-55068085-2"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-55068085-2');
    </script>
  </body>
</html>