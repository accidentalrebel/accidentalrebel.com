<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AccidentalRebel.com - Articles by AccidentalRebel</title>

    <meta name="description" content="SOC leader and content engineer at TryHackMe. Writing about AI, security tools, malware analysis, and reverse engineering.">

    <link rel="canonical" href="../">

    <link href="https://www.accidentalrebel.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="AccidentalRebel.com Atom Feed" />

    <link rel="stylesheet" href="../theme/css/main.css">

    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "Person",
        "name": "AccidentalRebel",
        "url": "..",
        "sameAs": ["https://www.linkedin.com/in/juan-karlo-licudine/", "https://github.com/accidentalrebel"]
    }
    </script>

</head>
<body>
    <div class="rebel-stripe"></div>
    <div class="progress-bar" id="progress"></div>

    <header>
        <div class="container-wide">
            <nav>
                <a href="../" class="site-title">Accidental<span class="rebel">Rebel</span>.com</a>
                <button class="menu-toggle" onclick="toggleMenu()">☰</button>
                <ul class="nav-links" id="navLinks">
                    <li><a href="../archives.html">Archives</a></li>
                    <li><a href="../categories.html">Categories</a></li>
                    <li><a href="../tags.html">Tags</a></li>
                            <li><a href="../category/cybersecurity-x-ai-news-roundup.html">Newsletter</a></li>
                            <li><a href="../pages/about.html">About</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <main>
        <div class="container-wide">
            <div class="layout">
                <div class="content">
    <article class="post-item">
        <header class="article-header">
            <a href="../category/misc.html" class="article-category-label">misc</a>
            <h2 class="post-title">
                <a href="../string-av-evasion-in-x64-assembly-part-1.html">String anti-virus evasion in x64 assembly (Part 1)</a>
            </h2>
            <div class="article-meta">
                <time datetime="2022-07-08T12:11:00+08:00">Fri 08 July 2022</time>
            </div>
        </header>

        <div class="article-content">
            <p>One of the features I implemented for my <a href="https://github.com/accidentalrebel/RATwurst">Remote Access Tool</a> was an anti-virus evasion capability in the form of strings obfuscation. It wouldn't fool an EDR or a reverse engineer but it was quick to implement so I added it. </p>
<p>This was over a year ago. I decided to revisit this feature to try and understand it better and find out if it is actually effective.</p>
<h2 id="what-to-expect">What to expect</h2>
<p>In this two-part blog post I will look into the following:</p>
<ul>
<li>Hiding argument strings</li>
<li>Hiding API call strings</li>
</ul>
<p>THe one you reading now is about the first one. I will be explaining how it's done in C and later convert it to x64 Windows Assembly so we can better understand what's happening under the hood.</p>
<h2 id="hiding-function-argument-strings">Hiding function argument strings</h2>
<p>I got the idea for this AV evasion technique from <a href="https://blog.scrt.ch/2020/06/19/engineering-antivirus-evasion/">this blog post</a>. The author posits that one part of an …</p>
            <a href="../string-av-evasion-in-x64-assembly-part-1.html" class="read-more">Read more &rarr;</a>
        </div>

        <div class="tags">
            <a href="../tag/evasion.html" class="tag">evasion</a>
            <a href="../tag/assembly.html" class="tag">assembly</a>
            <a href="../tag/av.html" class="tag">av</a>
        </div>
    </article>
    <article class="post-item">
        <header class="article-header">
            <a href="../category/misc.html" class="article-category-label">misc</a>
            <h2 class="post-title">
                <a href="../converting-a-malware-dropper-to-x64-assembly.html">Converting a malware dropper to x64 assembly</a>
            </h2>
            <div class="article-meta">
                <time datetime="2022-07-03T09:18:00+08:00">Sun 03 July 2022</time>
            </div>
        </header>

        <div class="article-content">
            <p>In this post I'll be listing down lessons I learned while converting a simple malware dropper written in C to x64 assembly. </p>
<p>I started this project as a way to deepen my understanding of assembly so I could be better in malware development and reverse engineering (And also because I love coding in assembly and would always find an excuse to use it).</p>
<h2 id="what-to-expect">What to expect</h2>
<p>I'll be going through sections of the C file and show the how it can be written accordingly in x64 Windows assembly. Take note, however, that the conversion is not one-to-one, meaning there are other ways of writing it. What I did was to structure the assembly code so that you can easily compare it with the C code while making sure that the end result will be the same.</p>
<p>I won't be covering the basics of assembly because <a href="https://sonictk.github.io/asm_tutorial/">this post</a> does a better …</p>
            <a href="../converting-a-malware-dropper-to-x64-assembly.html" class="read-more">Read more &rarr;</a>
        </div>

        <div class="tags">
            <a href="../tag/malware.html" class="tag">malware</a>
            <a href="../tag/assembly.html" class="tag">assembly</a>
            <a href="../tag/reverse-engineering.html" class="tag">reverse-engineering</a>
        </div>
    </article>
    <article class="post-item">
        <header class="article-header">
            <a href="../category/threat-hunting.html" class="article-category-label">threat-hunting</a>
            <h2 class="post-title">
                <a href="../cyber-corp-case-2-writeup-part-3.html">Cyber Corp Case 2 Writeup - Part 3</a>
            </h2>
            <div class="article-meta">
                <time datetime="2021-11-06T11:10:00+08:00">Sat 06 November 2021</time>
            </div>
        </header>

        <div class="article-content">
            <p>The <a href="https://cyberdefenders.org/labs/75">second case of the CyberCorp challenge</a> on <a href="https://cyberdefenders.org/">CyberDefenders.org</a> is all about threat hunting. Created by <a href="https://twitter.com/BlackMatter23">@BlackMatter23</a> and his team, this challenge is based on a real-world attack so it is perfect for gaining practical experience in threat hunting.</p>
<p>This write-up is the third and final part of this walkthrough. You could read <a href="threat-hunting-from-home-cyber-corp-wmi-persistence">Part 1 here</a> and <a href="cyber-corp-case-2-writeup-part-2">Part 2 here</a>.</p>
<h2 id="finding-the-post-reverse-shell-activity">Finding the post-reverse shell activity</h2>
<blockquote>
<p>Question 11. As a result of running a malicious code, which we talk about in questions 9 and 10, the attacker got a shell on the compromised host. Using this access, the attacker downloaded the Active Directory collection utility to the host in an encoded form. Specify a comma-separated, non-spaced link where the encoded version of the utility was downloaded and a SHA256 hash of the decoded version that was directly run by the attacker on the compromised host.</p>
</blockquote>
<p>So from the question, I …</p>
            <a href="../cyber-corp-case-2-writeup-part-3.html" class="read-more">Read more &rarr;</a>
        </div>

        <div class="tags">
            <a href="../tag/threat-hunting.html" class="tag">threat-hunting</a>
            <a href="../tag/cyberdefenders.html" class="tag">cyberdefenders</a>
        </div>
    </article>
    <article class="post-item">
        <header class="article-header">
            <a href="../category/threat-hunting.html" class="article-category-label">threat-hunting</a>
            <h2 class="post-title">
                <a href="../cyber-corp-case-2-writeup-part-2.html">Cyber Corp Case 2 Writeup - Part 2</a>
            </h2>
            <div class="article-meta">
                <time datetime="2021-11-03T12:00:00+08:00">Wed 03 November 2021</time>
            </div>
        </header>

        <div class="article-content">
            <p>The <a href="https://cyberdefenders.org/labs/75">second case of the CyberCorp challenge</a> on <a href="https://cyberdefenders.org/">CyberDefenders.org</a> is all about threat hunting. Created by <a href="https://twitter.com/BlackMatter23">@BlackMatter23</a> and his team, this challenge is based on a real-world attack so it is perfect for gaining practical experience in threat hunting.</p>
<p>This writeup is part 2 out of multiple parts. You could read <a href="threat-hunting-from-home-cyber-corp-wmi-persistence">Part 1 here</a> and <a href="cyber-corp-case-2-writeup-part-3">Part 3 here</a>.</p>
<h2 id="checking-dns-requests">Checking DNS Requests</h2>
<blockquote>
<p>Question 6. Specify the domain name of the resource from which the files mentioned in question 5 were supposedly downloaded as a result of malicious code execution.</p>
</blockquote>
<p>This one is easy. Using the same date range from the previous question, I changed the query to <code>event_type:DNSReq</code> (where "DNSReq" is short for "DNS Requests").</p>
<p><img alt="cyber-corp-case-2-writeup-part-2-01" src="../images/cyber-corp-case-2-writeup-part-2-01.png" /></p>
<p>We could easily see a DNS record being queried, which is our answer to this question.</p>
<h2 id="finding-the-encoded-executable-code">Finding the encoded executable code</h2>
<blockquote>
<p>Question 7. The first file downloaded (as a result of executing the code …</p></blockquote>
            <a href="../cyber-corp-case-2-writeup-part-2.html" class="read-more">Read more &rarr;</a>
        </div>

        <div class="tags">
            <a href="../tag/threat-hunting.html" class="tag">threat-hunting</a>
            <a href="../tag/cyberdefenders.html" class="tag">cyberdefenders</a>
        </div>
    </article>
    <article class="post-item">
        <header class="article-header">
            <a href="../category/threat-hunting.html" class="article-category-label">threat-hunting</a>
            <h2 class="post-title">
                <a href="../threat-hunting-from-home-cyber-corp-wmi-persistence.html">Cyber Corp Case 2 Writeup - Part 1</a>
            </h2>
            <div class="article-meta">
                <time datetime="2021-10-30T12:00:00+08:00">Sat 30 October 2021</time>
            </div>
        </header>

        <div class="article-content">
            <p>The <a href="https://cyberdefenders.org/labs/75">second case of the CyberCorp challenge</a> on <a href="https://cyberdefenders.org/">CyberDefenders.org</a> is all about threat hunting. Created by <a href="https://twitter.com/BlackMatter23">@BlackMatter23</a> and his team, this challenge is based on a real-world attack so it is perfect for gaining practical experience in threat hunting.</p>
<p>This writeup is part one out of multiple parts as I will be detailing my thought process and the steps I took for each question.</p>
<p>Edit: <a href="cyber-corp-case-2-writeup-part-2">Part 2</a> and <a href="cyber-corp-case-2-writeup-part-3">Part 3</a> is now out.</p>
<h2 id="understanding-wmi-persistence">Understanding WMI Persistence</h2>
<blockquote>
<p>Question 1. The Threat Hunting process usually starts with the analyst making a hypothesis about a possible compromise vector or techniques used by an attacker. In this scenario, your initial hypothesis is as follows: "The attacker used the WMI subscription mechanism to obtain persistence within the infrastructure". Verify this hypothesis and find the name of the WMI Event Consumer used by the attacker to maintain his foothold.</p>
</blockquote>
<p>So the question tells us that …</p>
            <a href="../threat-hunting-from-home-cyber-corp-wmi-persistence.html" class="read-more">Read more &rarr;</a>
        </div>

        <div class="tags">
            <a href="../tag/threat-hunting.html" class="tag">threat-hunting</a>
            <a href="../tag/cyberdefenders.html" class="tag">cyberdefenders</a>
        </div>
    </article>
    <article class="post-item">
        <header class="article-header">
            <a href="../category/tools.html" class="article-category-label">tools</a>
            <h2 class="post-title">
                <a href="../new-tool-preview-vattack.html">New Tool Preview: vATT&CK</a>
            </h2>
            <div class="article-meta">
                <time datetime="2021-10-18T20:33:00+08:00">Mon 18 October 2021</time>
            </div>
        </header>

        <div class="article-content">
            <p>I have released a new cybersecurity-related tool called <a href="https://github.com/accidentalrebel/vATTACK">vATT&amp;CK (Visual ATT&amp;CK)</a>. It is a relationship visualizer for the Mitre ATT&amp;CK framework.</p>
<p><img alt="new-tool-preview-vattack-01" src="../images/new-tool-preview-vattack-01.png" /></p>
<p>What the tool does is that it makes a visual map of the searched technique and all the related information. You can watch a video of the tool in action <a href="https://www.youtube.com/watch?v=xCc7aAqbSNI">here</a>.</p>
<p>Each node will be colored depending on it's category. The color legends is as follows:</p>
<ul>
<li>Pink - Related subtechniques</li>
<li>Orange - Malware that uses the searched technique</li>
<li>Red - Groups that uses the searched technique</li>
<li>Blue - Tools that use the searched technique</li>
<li>Yellow - Mitigations</li>
</ul>
<p>This tool is still in development. I plan to add a number of improvements such as:</p>
<ul>
<li>Ability to click on nodes and then update the visual map</li>
<li>Ability to search not just by technique, but also by other categories</li>
</ul>
<p>I also plan on releasing a live demo of the tool very soon in the …</p>
            <a href="../new-tool-preview-vattack.html" class="read-more">Read more &rarr;</a>
        </div>

        <div class="tags">
            <a href="../tag/tools.html" class="tag">tools</a>
            <a href="../tag/cybersecurity.html" class="tag">cybersecurity</a>
        </div>
    </article>
    <article class="post-item">
        <header class="article-header">
            <a href="../category/re.html" class="article-category-label">re</a>
            <h2 class="post-title">
                <a href="../ioli-crackme-0x04.html">IOLI Crackme 0x04</a>
            </h2>
            <div class="article-meta">
                <time datetime="2021-09-29T10:34:00+08:00">Wed 29 September 2021</time>
            </div>
        </header>

        <div class="article-content">
            <p>I am continuing my reverse engineering review by tackling the <em>IOLI crackmes</em> by <a href="https://twitter.com/pof">@pof</a>. These are beginner friendly challenges that is perfect for newbies or for those who want to review the basics like me. Check out my writeups for <a href="../ioli-crackme-0x00.html">0x00</a>, <a href="../ioli-crackme-0x01.html">0x01</a>, <a href="../ioli-crackme-0x02.html">0x02</a>, and <a href="../ioli-crackme-0x03.html">0x03</a>.</p>
<h1 id="getting-the-password">Getting the password</h1>
<p>Loading the program in IDA revealed something new. There is now a <code>_check</code> function that when opened looks more complicated than the previous challenges.</p>
<p><img alt="ioli-crackme-0x04-01" src="../images/ioli-crackme-0x04-01.png" /></p>
<p>The one thing that I immediately noticed is the call to the <code>_strlen</code> function similar to the previous challenge. This means that the length of the input string plays another important role.</p>
<p>One curious thing is the condition that leads to the "Password Incorrect" block, as shown below.</p>
<p><img alt="ioli-crackme-0x04-02" src="../images/ioli-crackme-0x04-02.png" /></p>
<div class="codehilite"><pre><span></span><code><span class="nf">call</span><span class="w"> </span><span class="no">_strlen</span>
<span class="nf">cmp</span><span class="w"> </span><span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">var_C</span><span class="p">],</span><span class="w"> </span><span class="no">eax</span>
<span class="nf">jnb</span><span class="w"> </span><span class="no">short</span><span class="w"> </span><span class="no">loc_401387</span>
</code></pre></div>

<p>From the looks of it, the check will fail if <code>var_C</code> (Which is our <code>var_counter</code> from the previous challenge) reaches the …</p>
            <a href="../ioli-crackme-0x04.html" class="read-more">Read more &rarr;</a>
        </div>

        <div class="tags">
            <a href="../tag/re.html" class="tag">re</a>
            <a href="../tag/crackme.html" class="tag">crackme</a>
        </div>
    </article>
    <article class="post-item">
        <header class="article-header">
            <a href="../category/malware.html" class="article-category-label">malware</a>
            <h2 class="post-title">
                <a href="../building-my-virtual-cybersecurity-home-lab.html">Building my Virtual Cybersecurity Home Lab</a>
            </h2>
            <div class="article-meta">
                <time datetime="2021-09-05T20:33:00+08:00">Sun 05 September 2021</time>
            </div>
        </header>

        <div class="article-content">
            <p>I have recently realized that one part of cybersecurity that I am lacking basic knowledge on is networking. I honestly did not think it was important when I was starting. It was the reason why I skipped Network+ so I could take Security+ directly. </p>
<p>Now I know better.</p>
<p>Ever since my realization, I have taken steps to patch the holes in my knowledge. I've started taking courses and bought books. But one thing that has made the most impact is me building my very own "homelab".</p>
<p>I first came to know of the concept of homelabs <a href="https://www.reddit.com/r/homelab/">from Reddit</a>. To those unfamiliar, it is the practice of building a networked environment to gain practical knowledge in networking and IT. One way to do this is by making a virtual network.</p>
<p>And so, over the past month, I have been building my very own virtual homelab with a focus on integrating cybersecurity …</p>
            <a href="../building-my-virtual-cybersecurity-home-lab.html" class="read-more">Read more &rarr;</a>
        </div>

        <div class="tags">
            <a href="../tag/malware.html" class="tag">malware</a>
            <a href="../tag/dev.html" class="tag">dev</a>
        </div>
    </article>
    <article class="post-item">
        <header class="article-header">
            <a href="../category/malware.html" class="article-category-label">malware</a>
            <h2 class="post-title">
                <a href="../making-a-rat.html">Making a RAT</a>
            </h2>
            <div class="article-meta">
                <time datetime="2021-07-13T14:56:00+08:00">Tue 13 July 2021</time>
            </div>
        </header>

        <div class="article-content">
            <p>A Remote Access Tool (RAT) is used to remotely access a computer. It has legitimate uses but it can also be used for malicious purposes. I've seen it used in malware I've analyzed and I've always been curious as to how it works.</p>
<p>I was following along the <a href="https://handmadehero.org/">Handmade Hero project</a> <sup id="fnref:1"><a class="footnote-ref" href="#fn:1">1</a></sup> when the topic about dynamic DLL loading came up. This is a process of dynamically loading a DLL at runtime which is useful if you want your program to check if a DLL is present in a system before loading it.</p>
<p>Two of the system calls that were discussed were LoadLibrary and GetProcAddress. These were familiar to me as I've seen them used on malware shellcode I analyzed in the past. I later learned that this is also used as an anti-virus evasion technique. I found this interesting.</p>
<p>Having learned how to do runtime DLL loading myself I …</p>
            <a href="../making-a-rat.html" class="read-more">Read more &rarr;</a>
        </div>

        <div class="tags">
            <a href="../tag/malware.html" class="tag">malware</a>
            <a href="../tag/dev.html" class="tag">dev</a>
        </div>
    </article>
    <article class="post-item">
        <header class="article-header">
            <a href="../category/security.html" class="article-category-label">security</a>
            <h2 class="post-title">
                <a href="../finding-phished-passwords-on-a-scam-site.html">Finding phished passwords on a scam site</a>
            </h2>
            <div class="article-meta">
                <time datetime="2021-05-01T20:56:00+08:00">Sat 01 May 2021</time>
            </div>
        </header>

        <div class="article-content">
            <p>Since my last post about <a href="investigating-an-fb-phishing-site">my investigations of a Facebook phishing site</a>, I have received several messages from friends asking me to check out other suspected phishing/scam sites. One of the most alarming out of them was this one where I was able to find the file where the scammer stores the phished usernames and passwords.</p>
<p><img alt="finding-phished-passwords-from-a-scam-site-01" src="../images/finding-phished-passwords-from-a-scam-site-01.png" /></p>
<p>This particular phishing site conducts its operations like this:</p>
<ul>
<li>An ad is shown on Facebook, promising free coupons for famous fast food restaurants</li>
<li>Clicking on the ad takes the user to a fake Facebook login page hosted on <em>blogger.com</em></li>
<li>Login page then sends phished username and passwords to a PHP file hosted on <em>000webhost</em></li>
</ul>
<p>The phished passwords are then stored in a <code>.txt</code> file (blatantly named, <code>victims.txt</code>), which is publicly accessible on an open directory. Getting to this directory involved following the scripts and the URLs used by the scammers. It's …</p>
            <a href="../finding-phished-passwords-on-a-scam-site.html" class="read-more">Read more &rarr;</a>
        </div>

        <div class="tags">
            <a href="../tag/phishing.html" class="tag">phishing</a>
            <a href="../tag/threat-hunting.html" class="tag">threat-hunting</a>
            <a href="../tag/osint.html" class="tag">osint</a>
        </div>
    </article>

<nav class="pagination">
        <a href="../index.html">&laquo; Previous</a>

        <a href="../index.html">1</a>
        <span class="current">2</span>
        <a href="../author/accidentalrebel3.html">3</a>
        <a href="../author/accidentalrebel4.html">4</a>
        <a href="../author/accidentalrebel5.html">5</a>

    <a href="../author/accidentalrebel3.html">Next &raquo;</a>
</nav>
                </div>
                <aside class="sidebar">
                    <div class="sidebar-sticky">
                        <img src="../theme/images/avatar.png" alt="AccidentalRebel" class="sidebar-avatar">
                        <h3 class="sidebar-name">AccidentalRebel</h3>
                        <p class="sidebar-realname">Juan Karlo Licudine</p>
                        <p class="sidebar-bio">SOC leader and content engineer at TryHackMe. Writing about AI, security tools, malware analysis, and reverse engineering.</p>
                        <ul class="sidebar-social">
                            <li><a href="https://www.linkedin.com/in/juan-karlo-licudine/" target="_blank" rel="noopener">LinkedIn</a></li>
                            <li><a href="https://github.com/accidentalrebel" target="_blank" rel="noopener">GitHub</a></li>
                        </ul>
                    </div>
                </aside>
            </div>
        </div>
    </main>

    <footer class="site-footer">
        <div class="container-wide">
            <div class="footer-content">
                <span>&copy; AccidentalRebel. SOC leader and content engineer at TryHackMe. Writing about AI, security tools, malware analysis, and reverse engineering.</span>
                <ul class="footer-links">
                    <li><a href="https://www.linkedin.com/in/juan-karlo-licudine/" target="_blank" rel="noopener">LinkedIn</a></li>
                    <li><a href="https://github.com/accidentalrebel" target="_blank" rel="noopener">GitHub</a></li>
                </ul>
            </div>
        </div>
    </footer>

    <script src="../theme/js/main.js"></script>

    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-55068085-2"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'UA-55068085-2');
    </script>
</body>
</html>